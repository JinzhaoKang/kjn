"use strict";(self["webpackChunkfeedback_analysis_enterprise"]=self["webpackChunkfeedback_analysis_enterprise"]||[]).push([[402],{1021:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var l=a(6768),s=a(4232);const n={class:"feedback-import"},o={class:"ant-upload-drag-icon"};function r(e,t,a,r,i,u){const c=(0,l.g2)("a-page-header"),d=(0,l.g2)("InboxOutlined"),p=(0,l.g2)("a-upload-dragger"),k=(0,l.g2)("a-divider"),f=(0,l.g2)("a-card"),_=(0,l.g2)("a-col"),m=(0,l.g2)("a-row"),b=(0,l.g2)("a-tag"),g=(0,l.g2)("a-button"),y=(0,l.g2)("a-table");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.bF)(c,{title:"反馈导入","sub-title":"批量导入用户反馈数据"}),(0,l.bF)(f,{title:"导入反馈数据",class:"import-card"},{default:(0,l.k6)(()=>[(0,l.bF)(p,{fileList:r.fileList,"onUpdate:fileList":t[0]||(t[0]=e=>r.fileList=e),name:"file",multiple:!1,action:r.uploadUrl,onChange:r.handleChange,"before-upload":r.beforeUpload,accept:".csv,.xlsx,.json"},{default:(0,l.k6)(()=>[(0,l.Lk)("p",o,[(0,l.bF)(d)]),t[1]||(t[1]=(0,l.Lk)("p",{class:"ant-upload-text"},"点击或拖拽文件到此区域上传",-1)),t[2]||(t[2]=(0,l.Lk)("p",{class:"ant-upload-hint"}," 支持CSV、Excel、JSON格式文件，单次上传仅支持单个文件 ",-1))]),_:1,__:[1,2]},8,["fileList","action","onChange","before-upload"]),(0,l.bF)(k),(0,l.bF)(m,{gutter:16},{default:(0,l.k6)(()=>[(0,l.bF)(_,{span:8},{default:(0,l.k6)(()=>[(0,l.bF)(f,{size:"small",title:"文件格式要求"},{default:(0,l.k6)(()=>t[3]||(t[3]=[(0,l.Lk)("p",null,"CSV格式：包含title, content, category, email等字段",-1),(0,l.Lk)("p",null,"Excel格式：第一行为标题行",-1),(0,l.Lk)("p",null,"JSON格式：对象数组格式",-1)])),_:1,__:[3]})]),_:1}),(0,l.bF)(_,{span:8},{default:(0,l.k6)(()=>[(0,l.bF)(f,{size:"small",title:"字段映射"},{default:(0,l.k6)(()=>t[4]||(t[4]=[(0,l.Lk)("p",null,"title: 反馈标题（必填）",-1),(0,l.Lk)("p",null,"content: 反馈内容（必填）",-1),(0,l.Lk)("p",null,"category: 分类（可选）",-1),(0,l.Lk)("p",null,"email: 联系邮箱（可选）",-1)])),_:1,__:[4]})]),_:1}),(0,l.bF)(_,{span:8},{default:(0,l.k6)(()=>[(0,l.bF)(f,{size:"small",title:"注意事项"},{default:(0,l.k6)(()=>t[5]||(t[5]=[(0,l.Lk)("p",null,"文件大小不超过10MB",-1),(0,l.Lk)("p",null,"单次最多导入1000条记录",-1),(0,l.Lk)("p",null,"重复数据将自动去重",-1)])),_:1,__:[5]})]),_:1})]),_:1})]),_:1}),r.importHistory.length>0?((0,l.uX)(),(0,l.Wv)(f,{key:0,title:"导入历史",class:"history-card"},{default:(0,l.k6)(()=>[(0,l.bF)(y,{columns:r.historyColumns,"data-source":r.importHistory,pagination:!1,size:"small"},{bodyCell:(0,l.k6)(({column:e,record:a})=>["status"===e.key?((0,l.uX)(),(0,l.Wv)(b,{key:0,color:r.getStatusColor(a.status)},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(r.getStatusText(a.status)),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"action"===e.key?((0,l.uX)(),(0,l.Wv)(g,{key:1,type:"link",size:"small",onClick:e=>r.downloadReport(a)},{default:(0,l.k6)(()=>t[6]||(t[6]=[(0,l.eW)(" 下载报告 ")])),_:2,__:[6]},1032,["onClick"])):(0,l.Q3)("",!0)]),_:1},8,["columns","data-source"])]),_:1})):(0,l.Q3)("",!0)])}var i=a(144),u=a(7694),c=a(3491),d={name:"FeedbackImport",components:{InboxOutlined:c.A},setup(){const e=(0,i.KR)([]),t=(0,i.KR)([]),a="/api/feedback/import",s=[{title:"文件名",dataIndex:"filename",key:"filename"},{title:"导入数量",dataIndex:"count",key:"count"},{title:"状态",dataIndex:"status",key:"status"},{title:"导入时间",dataIndex:"created_at",key:"created_at"},{title:"操作",key:"action"}],n=e=>{const t="text/csv"===e.type||"application/vnd.ms-excel"===e.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/json"===e.type;if(!t)return u.Ay.error("只支持CSV、Excel、JSON格式文件！"),!1;const a=e.size/1024/1024<10;return!!a||(u.Ay.error("文件大小不能超过10MB！"),!1)},o=e=>{const{status:t}=e.file;"done"===t?(u.Ay.success(`${e.file.name} 文件上传成功`),p()):"error"===t&&u.Ay.error(`${e.file.name} 文件上传失败`)},r=e=>{const t={success:"green",error:"red",processing:"blue"};return t[e]||"default"},c=e=>{const t={success:"成功",error:"失败",processing:"处理中"};return t[e]||"未知"},d=e=>{u.Ay.info("报告下载功能开发中...")},p=()=>{t.value=[{id:1,filename:"feedback_data.csv",count:156,status:"success",created_at:"2024-01-01 10:30:00"}]};return(0,l.sV)(()=>{p()}),{fileList:e,importHistory:t,uploadUrl:a,historyColumns:s,beforeUpload:n,handleChange:o,getStatusColor:r,getStatusText:c,downloadReport:d}}},p=a(1241);const k=(0,p.A)(d,[["render",r],["__scopeId","data-v-50ef4594"]]);var f=k}}]);
//# sourceMappingURL=402.af21b7bf.js.map