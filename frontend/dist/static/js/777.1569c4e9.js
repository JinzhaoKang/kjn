"use strict";(self["webpackChunkfeedback_analysis_enterprise"]=self["webpackChunkfeedback_analysis_enterprise"]||[]).push([[777],{777:function(t,e,s){s.r(e),s.d(e,{default:function(){return Qe}});var i=s(6768),a=s(4232);const n={class:"insights-management"},l={class:"page-header-wrapper"},r={class:"header-content"},c={class:"header-title"},o={class:"title-icon"},d={class:"header-actions"},g={class:"stats-overview"},u={class:"premium-stat-card insights-card"},h={class:"stat-icon"},k={class:"stat-content"},v={class:"stat-value"},p={class:"premium-stat-card priority-card"},_={class:"stat-icon"},m={class:"stat-content"},y={class:"stat-value"},b={class:"premium-stat-card actions-card"},f={class:"stat-icon"},L={class:"stat-content"},C={class:"stat-value"},F={class:"premium-stat-card urgent-card"},I={class:"stat-icon"},A={class:"stat-content"},P={class:"stat-value"},w={class:"main-content-area"},S={class:"insights-main-panel"},E={class:"data-source-sidebar"},O={class:"card-title"},W={class:"data-source-content"},x={class:"data-stats"},T={class:"stats-grid"},X={class:"stat-item"},D={class:"stat-number"},K={class:"stat-item"},z={class:"stat-number"},R={class:"sentiment-distribution"},B={class:"sentiment-item positive"},G={class:"sentiment-item negative"},U={class:"sentiment-item neutral"},$={class:"data-actions"},M={class:"last-update"},Q={class:"analysis-details-section"},H={class:"analysis-card category-analysis"},V={class:"card-header"},j={class:"header-icon"},Y={class:"card-content"},q={class:"category-list"},J=["onClick"],N={class:"category-info"},Z={class:"category-icon"},tt={class:"category-details"},et={class:"category-name"},st={class:"category-count"},it={class:"category-badge"},at={class:"category-progress"},nt={class:"analysis-card priority-analysis"},lt={class:"card-header"},rt={class:"header-icon"},ct={class:"card-content"},ot={class:"priority-list"},dt={class:"priority-header"},gt={class:"priority-count"},ut={class:"priority-plans"},ht={class:"plan-title"},kt={key:0,class:"more-plans"},vt={class:"analysis-card activity-analysis"},pt={class:"card-header"},_t={class:"header-icon"},mt={class:"card-content"},yt={class:"activity-timeline"},bt={key:0,class:"timeline-item"},ft={class:"timeline-content"},Lt={class:"timeline-desc"},Ct={class:"timeline-time"},Ft={key:1,class:"timeline-item"},It={class:"timeline-content"},At={class:"timeline-desc"},Pt={class:"timeline-time"},wt={key:2,class:"timeline-item"},St={class:"timeline-content"},Et={class:"timeline-desc"},Ot={class:"timeline-time"},Wt={key:3,class:"timeline-item"},xt={class:"timeline-content"},Tt={class:"timeline-desc"},Xt={class:"feedback-selector"},Dt={class:"selector-filters"},Kt={class:"feedback-list"};function zt(t,e,s,zt,Rt,Bt){const Gt=(0,i.g2)("BulbOutlined"),Ut=(0,i.g2)("a-button"),$t=(0,i.g2)("PlayCircleOutlined"),Mt=(0,i.g2)("ReloadOutlined"),Qt=(0,i.g2)("a-space"),Ht=(0,i.g2)("EyeOutlined"),Vt=(0,i.g2)("a-col"),jt=(0,i.g2)("ExclamationCircleOutlined"),Yt=(0,i.g2)("CheckCircleOutlined"),qt=(0,i.g2)("ClockCircleOutlined"),Jt=(0,i.g2)("a-row"),Nt=(0,i.g2)("InsightsPanel"),Zt=(0,i.g2)("DatabaseOutlined"),te=(0,i.g2)("SettingOutlined"),ee=(0,i.g2)("SelectOutlined"),se=(0,i.g2)("a-card"),ie=(0,i.g2)("LineChartOutlined"),ae=(0,i.g2)("a-badge"),ne=(0,i.g2)("a-progress"),le=(0,i.g2)("TrophyOutlined"),re=(0,i.g2)("a-tag"),ce=(0,i.g2)("a-input-number"),oe=(0,i.g2)("a-form-item"),de=(0,i.g2)("a-switch"),ge=(0,i.g2)("a-range-picker"),ue=(0,i.g2)("a-select-option"),he=(0,i.g2)("a-select"),ke=(0,i.g2)("a-form"),ve=(0,i.g2)("a-modal"),pe=(0,i.g2)("SearchOutlined"),_e=(0,i.g2)("a-input"),me=(0,i.g2)("a-table");return(0,i.uX)(),(0,i.CE)("div",n,[(0,i.Lk)("div",l,[e[14]||(e[14]=(0,i.Lk)("div",{class:"header-background"},null,-1)),(0,i.Lk)("div",r,[(0,i.Lk)("div",c,[(0,i.Lk)("div",o,[(0,i.bF)(Gt)]),e[10]||(e[10]=(0,i.Lk)("div",{class:"title-text"},[(0,i.Lk)("h1",null,"智能洞察中心"),(0,i.Lk)("p",null,"基于AI驱动的用户反馈洞察分析与智能决策支持")],-1))]),(0,i.Lk)("div",d,[(0,i.bF)(Qt,{size:"large"},{default:(0,i.k6)(()=>[(0,i.bF)(Ut,{type:"primary",size:"large",onClick:zt.generateInsights,loading:zt.isGenerating,class:"primary-action-btn"},{default:(0,i.k6)(()=>[(0,i.bF)(Gt),e[11]||(e[11]=(0,i.eW)(" 生成洞察 "))]),_:1,__:[11]},8,["onClick","loading"]),(0,i.bF)(Ut,{size:"large",onClick:zt.getDemo,loading:zt.isGenerating,class:"secondary-action-btn"},{default:(0,i.k6)(()=>[(0,i.bF)($t),e[12]||(e[12]=(0,i.eW)(" 演示模式 "))]),_:1,__:[12]},8,["onClick","loading"]),(0,i.bF)(Ut,{size:"large",onClick:zt.refreshData,class:"secondary-action-btn"},{default:(0,i.k6)(()=>[(0,i.bF)(Mt),e[13]||(e[13]=(0,i.eW)(" 刷新数据 "))]),_:1,__:[13]},8,["onClick"])]),_:1})])])]),(0,i.Lk)("div",g,[(0,i.bF)(Jt,{gutter:[24,24]},{default:(0,i.k6)(()=>[(0,i.bF)(Vt,{xs:24,sm:12,xl:6},{default:(0,i.k6)(()=>[(0,i.Lk)("div",u,[(0,i.Lk)("div",h,[(0,i.bF)(Ht)]),(0,i.Lk)("div",k,[(0,i.Lk)("div",v,(0,a.v_)(zt.insightsStats.total_insights||0),1),e[15]||(e[15]=(0,i.Lk)("div",{class:"stat-label"},"总洞察数",-1)),e[16]||(e[16]=(0,i.Lk)("div",{class:"stat-trend"},[(0,i.Lk)("span",{class:"trend-indicator positive"},"↗ +12%")],-1))])])]),_:1}),(0,i.bF)(Vt,{xs:24,sm:12,xl:6},{default:(0,i.k6)(()=>[(0,i.Lk)("div",p,[(0,i.Lk)("div",_,[(0,i.bF)(jt)]),(0,i.Lk)("div",m,[(0,i.Lk)("div",y,(0,a.v_)(zt.highPriorityInsights.length||0),1),e[17]||(e[17]=(0,i.Lk)("div",{class:"stat-label"},"高优先级洞察",-1)),e[18]||(e[18]=(0,i.Lk)("div",{class:"stat-trend"},[(0,i.Lk)("span",{class:"trend-indicator warning"},"⚠ 需关注")],-1))])])]),_:1}),(0,i.bF)(Vt,{xs:24,sm:12,xl:6},{default:(0,i.k6)(()=>[(0,i.Lk)("div",b,[(0,i.Lk)("div",f,[(0,i.bF)(Yt)]),(0,i.Lk)("div",L,[(0,i.Lk)("div",C,(0,a.v_)(zt.allActionPlans.length||0),1),e[19]||(e[19]=(0,i.Lk)("div",{class:"stat-label"},"执行计划数",-1)),e[20]||(e[20]=(0,i.Lk)("div",{class:"stat-trend"},[(0,i.Lk)("span",{class:"trend-indicator positive"},"✓ 就绪")],-1))])])]),_:1}),(0,i.bF)(Vt,{xs:24,sm:12,xl:6},{default:(0,i.k6)(()=>[(0,i.Lk)("div",F,[(0,i.Lk)("div",I,[(0,i.bF)(qt)]),(0,i.Lk)("div",A,[(0,i.Lk)("div",P,(0,a.v_)(zt.urgentActionPlans.length||0),1),e[21]||(e[21]=(0,i.Lk)("div",{class:"stat-label"},"紧急任务",-1)),e[22]||(e[22]=(0,i.Lk)("div",{class:"stat-trend"},[(0,i.Lk)("span",{class:"trend-indicator urgent"},"🔥 紧急")],-1))])])]),_:1})]),_:1})]),(0,i.Lk)("div",w,[(0,i.bF)(Jt,{gutter:[32,32]},{default:(0,i.k6)(()=>[(0,i.bF)(Vt,{xs:24,lg:16,xl:18},{default:(0,i.k6)(()=>[(0,i.Lk)("div",S,[(0,i.bF)(Nt)])]),_:1}),(0,i.bF)(Vt,{xs:24,lg:8,xl:6},{default:(0,i.k6)(()=>[(0,i.Lk)("div",E,[(0,i.bF)(se,{class:"data-source-card",bordered:!1},{title:(0,i.k6)(()=>[(0,i.Lk)("div",O,[(0,i.bF)(Zt),e[23]||(e[23]=(0,i.eW)(" 反馈数据源 "))])]),extra:(0,i.k6)(()=>[(0,i.bF)(Ut,{type:"link",size:"small",onClick:e[0]||(e[0]=t=>zt.showDataConfig=!0)},{default:(0,i.k6)(()=>[(0,i.bF)(te)]),_:1})]),default:(0,i.k6)(()=>[(0,i.Lk)("div",W,[(0,i.Lk)("div",x,[(0,i.Lk)("div",T,[(0,i.Lk)("div",X,[(0,i.Lk)("div",D,(0,a.v_)(zt.feedbackStats.total_feedback||0),1),e[24]||(e[24]=(0,i.Lk)("div",{class:"stat-desc"},"反馈总数",-1))]),(0,i.Lk)("div",K,[(0,i.Lk)("div",z,(0,a.v_)(zt.feedbackStats.high_priority_count||0),1),e[25]||(e[25]=(0,i.Lk)("div",{class:"stat-desc"},"高优先级",-1))])]),(0,i.Lk)("div",R,[(0,i.Lk)("div",B,[e[26]||(e[26]=(0,i.Lk)("span",{class:"sentiment-dot"},null,-1)),(0,i.eW)(" 正面: "+(0,a.v_)(zt.feedbackStats.sentiment_distribution?.positive||0),1)]),(0,i.Lk)("div",G,[e[27]||(e[27]=(0,i.Lk)("span",{class:"sentiment-dot"},null,-1)),(0,i.eW)(" 负面: "+(0,a.v_)(zt.feedbackStats.sentiment_distribution?.negative||0),1)]),(0,i.Lk)("div",U,[e[28]||(e[28]=(0,i.Lk)("span",{class:"sentiment-dot"},null,-1)),(0,i.eW)(" 中性: "+(0,a.v_)(zt.feedbackStats.sentiment_distribution?.neutral||0),1)])])]),(0,i.Lk)("div",$,[(0,i.bF)(Ut,{block:"",type:"dashed",onClick:zt.refreshFeedbackData,class:"action-btn"},{default:(0,i.k6)(()=>[(0,i.bF)(Zt),e[29]||(e[29]=(0,i.eW)(" 刷新反馈数据 "))]),_:1,__:[29]},8,["onClick"]),(0,i.bF)(Ut,{block:"",type:"dashed",onClick:e[1]||(e[1]=t=>zt.showFeedbackSelector=!0),class:"action-btn"},{default:(0,i.k6)(()=>[(0,i.bF)(ee),e[30]||(e[30]=(0,i.eW)(" 选择反馈数据 "))]),_:1,__:[30]})]),(0,i.Lk)("div",M,[(0,i.Lk)("small",null,"最近更新: "+(0,a.v_)(zt.formatTime(zt.insightsStats.last_generation_time)),1)])])]),_:1})])]),_:1})]),_:1})]),(0,i.Lk)("div",Q,[(0,i.bF)(Jt,{gutter:[32,32]},{default:(0,i.k6)(()=>[(0,i.bF)(Vt,{xs:24,lg:8},{default:(0,i.k6)(()=>[(0,i.Lk)("div",H,[(0,i.Lk)("div",V,[(0,i.Lk)("div",j,[(0,i.bF)(ie)]),e[31]||(e[31]=(0,i.Lk)("div",{class:"header-title"},"洞察分类分析",-1))]),(0,i.Lk)("div",Y,[(0,i.Lk)("div",q,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(zt.insightsByType,(t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:e,class:(0,a.C4)(["category-item",{active:zt.selectedCategory===e}]),onClick:t=>zt.selectedCategory=e},[(0,i.Lk)("div",N,[(0,i.Lk)("div",Z,[((0,i.uX)(),(0,i.Wv)((0,i.$y)(zt.getInsightIcon(e))))]),(0,i.Lk)("div",tt,[(0,i.Lk)("div",et,(0,a.v_)(zt.getInsightTypeText(e)),1),(0,i.Lk)("div",st,(0,a.v_)(t.length)+" 个洞察",1)]),(0,i.Lk)("div",it,[(0,i.bF)(ae,{count:t.length,style:(0,a.Tr)({backgroundColor:zt.getInsightTypeColor(e)})},null,8,["count","style"])])]),(0,i.Lk)("div",at,[(0,i.bF)(ne,{percent:zt.allInsights.length>0?Math.round(t.length/zt.allInsights.length*100):0,size:"small","stroke-color":zt.getInsightTypeColor(e),"show-info":!1},null,8,["percent","stroke-color"])])],10,J))),128))])])])]),_:1}),(0,i.bF)(Vt,{xs:24,lg:8},{default:(0,i.k6)(()=>[(0,i.Lk)("div",nt,[(0,i.Lk)("div",lt,[(0,i.Lk)("div",rt,[(0,i.bF)(le)]),e[32]||(e[32]=(0,i.Lk)("div",{class:"header-title"},"优先级分布",-1))]),(0,i.Lk)("div",ct,[(0,i.Lk)("div",ot,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(zt.actionPlansByPriority,(t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:e,class:"priority-item"},[(0,i.Lk)("div",dt,[(0,i.bF)(re,{color:zt.getPriorityColor(e),class:"priority-tag"},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(e),1)]),_:2},1032,["color"]),(0,i.Lk)("span",gt,(0,a.v_)(t.length)+" 个计划",1)]),(0,i.Lk)("div",ut,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.slice(0,2),t=>((0,i.uX)(),(0,i.CE)("div",{key:t.plan_id,class:"plan-preview"},[(0,i.Lk)("div",ht,(0,a.v_)(t.title),1)]))),128)),t.length>2?((0,i.uX)(),(0,i.CE)("div",kt,[(0,i.bF)(Ut,{type:"link",size:"small"},{default:(0,i.k6)(()=>[(0,i.eW)(" 查看全部 "+(0,a.v_)(t.length)+" 个计划 ",1)]),_:2},1024)])):(0,i.Q3)("",!0)])]))),128))])])])]),_:1}),(0,i.bF)(Vt,{xs:24,lg:8},{default:(0,i.k6)(()=>[(0,i.Lk)("div",vt,[(0,i.Lk)("div",pt,[(0,i.Lk)("div",_t,[(0,i.bF)(qt)]),e[33]||(e[33]=(0,i.Lk)("div",{class:"header-title"},"最近活动",-1))]),(0,i.Lk)("div",mt,[(0,i.Lk)("div",yt,[zt.allInsights.length>0?((0,i.uX)(),(0,i.CE)("div",bt,[e[35]||(e[35]=(0,i.Lk)("div",{class:"timeline-dot insights"},null,-1)),(0,i.Lk)("div",ft,[e[34]||(e[34]=(0,i.Lk)("div",{class:"timeline-title"},"生成洞察分析",-1)),(0,i.Lk)("div",Lt,"成功生成 "+(0,a.v_)(zt.allInsights.length)+" 个智能洞察",1),(0,i.Lk)("div",Ct,(0,a.v_)(zt.formatTime(zt.insightsStats.last_generation_time)),1)])])):(0,i.Q3)("",!0),zt.allActionPlans.length>0?((0,i.uX)(),(0,i.CE)("div",Ft,[e[37]||(e[37]=(0,i.Lk)("div",{class:"timeline-dot actions"},null,-1)),(0,i.Lk)("div",It,[e[36]||(e[36]=(0,i.Lk)("div",{class:"timeline-title"},"制定执行计划",-1)),(0,i.Lk)("div",At,"创建 "+(0,a.v_)(zt.allActionPlans.length)+" 个可执行计划",1),(0,i.Lk)("div",Pt,(0,a.v_)(zt.formatTime(zt.insightsStats.last_generation_time)),1)])])):(0,i.Q3)("",!0),zt.highPriorityInsights.length>0?((0,i.uX)(),(0,i.CE)("div",wt,[e[39]||(e[39]=(0,i.Lk)("div",{class:"timeline-dot priority"},null,-1)),(0,i.Lk)("div",St,[e[38]||(e[38]=(0,i.Lk)("div",{class:"timeline-title"},"识别关键问题",-1)),(0,i.Lk)("div",Et,"发现 "+(0,a.v_)(zt.highPriorityInsights.length)+" 个高优先级问题",1),(0,i.Lk)("div",Ot,(0,a.v_)(zt.formatTime(zt.insightsStats.last_generation_time)),1)])])):(0,i.Q3)("",!0),zt.feedbackStats.total_feedback>0?((0,i.uX)(),(0,i.CE)("div",Wt,[e[42]||(e[42]=(0,i.Lk)("div",{class:"timeline-dot data"},null,-1)),(0,i.Lk)("div",xt,[e[40]||(e[40]=(0,i.Lk)("div",{class:"timeline-title"},"数据源更新",-1)),(0,i.Lk)("div",Tt,"处理 "+(0,a.v_)(zt.feedbackStats.total_feedback)+" 条用户反馈",1),e[41]||(e[41]=(0,i.Lk)("div",{class:"timeline-time"},"刚刚",-1))])])):(0,i.Q3)("",!0)])])])]),_:1})]),_:1})]),(0,i.bF)(ve,{open:zt.showDataConfig,"onUpdate:open":e[6]||(e[6]=t=>zt.showDataConfig=t),title:"数据源配置",width:"600px",onOk:zt.updateDataConfig},{default:(0,i.k6)(()=>[(0,i.bF)(ke,{model:zt.dataConfig,"label-col":{span:6},"wrapper-col":{span:18}},{default:(0,i.k6)(()=>[(0,i.bF)(oe,{label:"反馈数量限制"},{default:(0,i.k6)(()=>[(0,i.bF)(ce,{value:zt.dataConfig.feedback_limit,"onUpdate:value":e[2]||(e[2]=t=>zt.dataConfig.feedback_limit=t),min:10,max:500,style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(oe,{label:"包含执行计划"},{default:(0,i.k6)(()=>[(0,i.bF)(de,{checked:zt.dataConfig.include_action_plans,"onUpdate:checked":e[3]||(e[3]=t=>zt.dataConfig.include_action_plans=t)},null,8,["checked"])]),_:1}),(0,i.bF)(oe,{label:"时间范围"},{default:(0,i.k6)(()=>[(0,i.bF)(ge,{value:zt.dataConfig.date_range,"onUpdate:value":e[4]||(e[4]=t=>zt.dataConfig.date_range=t)},null,8,["value"])]),_:1}),(0,i.bF)(oe,{label:"情感过滤"},{default:(0,i.k6)(()=>[(0,i.bF)(he,{value:zt.dataConfig.sentiment_filter,"onUpdate:value":e[5]||(e[5]=t=>zt.dataConfig.sentiment_filter=t),mode:"multiple",placeholder:"选择情感类型",style:{width:"100%"}},{default:(0,i.k6)(()=>[(0,i.bF)(ue,{value:"positive"},{default:(0,i.k6)(()=>e[43]||(e[43]=[(0,i.eW)("正面")])),_:1,__:[43]}),(0,i.bF)(ue,{value:"negative"},{default:(0,i.k6)(()=>e[44]||(e[44]=[(0,i.eW)("负面")])),_:1,__:[44]}),(0,i.bF)(ue,{value:"neutral"},{default:(0,i.k6)(()=>e[45]||(e[45]=[(0,i.eW)("中性")])),_:1,__:[45]})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","onOk"]),(0,i.bF)(ve,{open:zt.showFeedbackSelector,"onUpdate:open":e[9]||(e[9]=t=>zt.showFeedbackSelector=t),title:"选择反馈数据",width:"800px",onOk:zt.generateInsightsFromSelected},{default:(0,i.k6)(()=>[(0,i.Lk)("div",Xt,[(0,i.Lk)("div",Dt,[(0,i.bF)(Qt,null,{default:(0,i.k6)(()=>[(0,i.bF)(_e,{value:zt.feedbackSearch,"onUpdate:value":e[7]||(e[7]=t=>zt.feedbackSearch=t),placeholder:"搜索反馈内容",style:{width:"200px"}},{prefix:(0,i.k6)(()=>[(0,i.bF)(pe)]),_:1},8,["value"]),(0,i.bF)(he,{value:zt.feedbackCategoryFilter,"onUpdate:value":e[8]||(e[8]=t=>zt.feedbackCategoryFilter=t),placeholder:"选择分类",style:{width:"120px"},allowClear:""},{default:(0,i.k6)(()=>[(0,i.bF)(ue,{value:"bug"},{default:(0,i.k6)(()=>e[46]||(e[46]=[(0,i.eW)("问题")])),_:1,__:[46]}),(0,i.bF)(ue,{value:"feature"},{default:(0,i.k6)(()=>e[47]||(e[47]=[(0,i.eW)("功能")])),_:1,__:[47]}),(0,i.bF)(ue,{value:"performance"},{default:(0,i.k6)(()=>e[48]||(e[48]=[(0,i.eW)("性能")])),_:1,__:[48]}),(0,i.bF)(ue,{value:"ui_ux"},{default:(0,i.k6)(()=>e[49]||(e[49]=[(0,i.eW)("界面")])),_:1,__:[49]})]),_:1},8,["value"])]),_:1})]),(0,i.Lk)("div",Kt,[(0,i.bF)(me,{columns:zt.feedbackColumns,"data-source":zt.filteredFeedbacks,"row-selection":zt.feedbackRowSelection,pagination:{pageSize:5},size:"small"},{bodyCell:(0,i.k6)(({column:t,record:e})=>["sentiment"===t.key?((0,i.uX)(),(0,i.Wv)(re,{key:0,color:zt.getSentimentColor(e.sentiment)},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(zt.getSentimentText(e.sentiment)),1)]),_:2},1032,["color"])):(0,i.Q3)("",!0)]),_:1},8,["columns","data-source","row-selection"])])])]),_:1},8,["open","onOk"])])}var Rt=s(144),Bt=s(7694),Gt=s(657),Ut=s(4288);const $t=(0,Gt.nY)("insights",{state:()=>({insightsStatus:"idle",insights:[],actionPlans:[],generationConfig:{feedback_limit:50,include_action_plans:!0,filters:{}},stats:{total_insights:0,insights_by_type:{},action_plans_by_priority:{},last_generation_time:null},error:null}),getters:{isGenerating:t=>"generating"===t.insightsStatus,isCompleted:t=>"completed"===t.insightsStatus,hasError:t=>"error"===t.insightsStatus,allInsights:t=>t.insights,allActionPlans:t=>t.actionPlans,insightsByType:t=>{const e={};return t.insights.forEach(t=>{const s=t.insight_type||"general";e[s]||(e[s]=[]),e[s].push(t)}),e},actionPlansByPriority:t=>{const e={};return t.actionPlans.forEach(t=>{const s=t.priority||"P3";e[s]||(e[s]=[]),e[s].push(t)}),e},highPriorityInsights:t=>t.insights.filter(t=>"high"===t.impact_level||t.confidence_score>.8),urgentActionPlans:t=>t.actionPlans.filter(t=>"P0"===t.priority||"P1"===t.priority),insightsStats:t=>t.stats,lastError:t=>t.error},actions:{async generateInsights(){this.insightsStatus="generating",this.error=null;try{const t=await Ut.Ko.generateInsights(this.generationConfig),{insights:e,action_plans:s,stats:i}=t.data;return this.insights=e||[],this.actionPlans=s||[],this.stats={...this.stats,total_insights:e?.length||0,last_generation_time:(new Date).toISOString(),...i},this.insightsStatus="completed",t.data}catch(t){throw console.error("生成洞察失败:",t),this.error=t.response?.data?.detail||t.message,this.insightsStatus="error",t}},async generateManualInsights(t){this.insightsStatus="generating",this.error=null;try{const e=await Ut.Ko.generateManualInsights({feedback_ids:t,focus_areas:["用户体验","产品功能","性能优化"],business_context:"基于用户反馈的产品改进分析"}),{insights:s,action_plans:i}=e.data;return this.insights=s||[],this.actionPlans=i||[],this.insightsStatus="completed",e.data}catch(e){throw console.error("手动生成洞察失败:",e),this.error=e.response?.data?.detail||e.message,this.insightsStatus="error",e}},async getInsightsDemo(){this.insightsStatus="generating",this.error=null;try{const t=await Ut.Ko.getInsightsDemo(),{insights:e,action_plans:s}=t.data;return this.insights=e||[],this.actionPlans=s||[],this.insightsStatus="completed",t.data}catch(t){throw this.error=t.response?.data?.detail||t.message,this.insightsStatus="error",t}},updateGenerationConfig(t){this.generationConfig={...this.generationConfig,...t}},clearInsights(){this.insights=[],this.actionPlans=[],this.insightsStatus="idle",this.error=null},async checkInsightsHealth(){try{const t=await Ut.Ko.checkInsightsHealth();return t.data}catch(t){throw this.error=t.response?.data?.detail||t.message,t}},addInsight(t){this.insights.push(t)},updateInsight(t,e){t>=0&&t<this.insights.length&&(this.insights[t]=e)},removeInsight(t){t>=0&&t<this.insights.length&&this.insights.splice(t,1)},addActionPlan(t){this.actionPlans.push(t)},updateActionPlan(t,e){t>=0&&t<this.actionPlans.length&&(this.actionPlans[t]=e)},removeActionPlan(t){t>=0&&t<this.actionPlans.length&&this.actionPlans.splice(t,1)}}}),Mt={class:"insights-panel"},Qt={class:"insights-header"},Ht={class:"insights-title"},Vt={class:"insights-actions"},jt={key:0,class:"error-alert"},Yt={key:1,class:"generating-state"},qt={key:2,class:"insights-content"},Jt={class:"insights-section"},Nt={class:"section-title"},Zt={class:"insights-list"},te={class:"insight-header"},ee={class:"insight-type"},se={class:"insight-confidence"},ie={class:"insight-title"},ae={class:"insight-description"},ne={class:"insight-meta"},le={class:"insight-segments"},re={class:"action-plans-section"},ce={class:"section-title"},oe={class:"action-plans-list"},de={class:"plan-header"},ge={class:"plan-priority"},ue={class:"plan-effort"},he={class:"plan-title"},ke={class:"plan-summary"},ve={class:"plan-meta"},pe={class:"plan-owner"},_e={class:"plan-timeline"},me={class:"plan-metrics"},ye={class:"metrics-list"},be={key:3,class:"empty-state"};function fe(t,e,s,n,l,r){const c=(0,i.g2)("BulbOutlined"),o=(0,i.g2)("RiseOutlined"),d=(0,i.g2)("a-button"),g=(0,i.g2)("a-alert"),u=(0,i.g2)("LoadingOutlined"),h=(0,i.g2)("a-spin"),k=(0,i.g2)("EyeOutlined"),v=(0,i.g2)("a-progress"),p=(0,i.g2)("a-tag"),_=(0,i.g2)("CheckCircleOutlined"),m=(0,i.g2)("ClockCircleOutlined"),y=(0,i.g2)("UserOutlined"),b=(0,i.g2)("CalendarOutlined"),f=(0,i.g2)("a-empty");return(0,i.uX)(),(0,i.CE)("div",Mt,[(0,i.Lk)("div",Qt,[(0,i.Lk)("h3",Ht,[(0,i.bF)(c,{class:"title-icon"}),e[0]||(e[0]=(0,i.eW)(" 智能洞察 "))]),(0,i.Lk)("div",Vt,[(0,i.bF)(d,{type:"primary",size:"small",onClick:n.generateInsights,loading:n.isGenerating},{default:(0,i.k6)(()=>[(0,i.bF)(o),e[1]||(e[1]=(0,i.eW)(" 生成洞察 "))]),_:1,__:[1]},8,["onClick","loading"]),(0,i.bF)(d,{size:"small",onClick:n.getDemo,loading:n.isGenerating},{default:(0,i.k6)(()=>e[2]||(e[2]=[(0,i.eW)(" 演示 ")])),_:1,__:[2]},8,["onClick","loading"]),(0,i.bF)(d,{size:"small",onClick:n.clearInsights,disabled:!n.hasInsights},{default:(0,i.k6)(()=>e[3]||(e[3]=[(0,i.eW)(" 清空 ")])),_:1,__:[3]},8,["onClick","disabled"])])]),n.hasError?((0,i.uX)(),(0,i.CE)("div",jt,[(0,i.bF)(g,{message:n.lastError,type:"error","show-icon":"",closable:"",onClose:n.clearError},null,8,["message","onClose"])])):(0,i.Q3)("",!0),n.isGenerating?((0,i.uX)(),(0,i.CE)("div",Yt,[(0,i.bF)(h,{size:"large"},{indicator:(0,i.k6)(()=>[(0,i.bF)(u,{style:{"font-size":"24px",color:"#1890ff"}})]),_:1}),e[4]||(e[4]=(0,i.Lk)("div",{class:"generating-text"},"正在生成洞察...",-1))])):n.hasInsights?((0,i.uX)(),(0,i.CE)("div",qt,[(0,i.Lk)("div",Jt,[(0,i.Lk)("h4",Nt,[(0,i.bF)(k),e[5]||(e[5]=(0,i.eW)(" 洞察分析 "))]),(0,i.Lk)("div",Zt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.insights,(t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:e,class:(0,a.C4)(["insight-item",`insight-${t.insight_type}`])},[(0,i.Lk)("div",te,[(0,i.Lk)("div",ee,[((0,i.uX)(),(0,i.Wv)((0,i.$y)(n.getInsightIcon(t.insight_type)))),(0,i.eW)(" "+(0,a.v_)(n.getInsightTypeText(t.insight_type)),1)]),(0,i.Lk)("div",se,[(0,i.bF)(v,{percent:Math.round(100*t.confidence_score),size:"small","stroke-color":n.getConfidenceColor(t.confidence_score)},null,8,["percent","stroke-color"])])]),(0,i.Lk)("div",ie,(0,a.v_)(t.title),1),(0,i.Lk)("div",ae,(0,a.v_)(t.description),1),(0,i.Lk)("div",ne,[(0,i.bF)(p,{color:n.getImpactColor(t.impact_level)},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(n.getImpactText(t.impact_level)),1)]),_:2},1032,["color"]),(0,i.Lk)("span",le," 影响用户: "+(0,a.v_)(t.affected_user_segments?.join(", ")||"所有用户"),1)])],2))),128))])]),(0,i.Lk)("div",re,[(0,i.Lk)("h4",ce,[(0,i.bF)(_),e[6]||(e[6]=(0,i.eW)(" 执行计划 "))]),(0,i.Lk)("div",oe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.actionPlans,(t,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:(0,a.C4)(["action-plan-item",`priority-${t.priority}`])},[(0,i.Lk)("div",de,[(0,i.Lk)("div",ge,[(0,i.bF)(p,{color:n.getPriorityColor(t.priority)},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(t.priority),1)]),_:2},1032,["color"])]),(0,i.Lk)("div",ue,[(0,i.bF)(m),(0,i.eW)(" "+(0,a.v_)(t.estimated_effort),1)])]),(0,i.Lk)("div",he,(0,a.v_)(t.title),1),(0,i.Lk)("div",ke,(0,a.v_)(t.summary),1),(0,i.Lk)("div",ve,[(0,i.Lk)("div",pe,[(0,i.bF)(y),(0,i.eW)(" "+(0,a.v_)(t.owner_team),1)]),(0,i.Lk)("div",_e,[(0,i.bF)(b),(0,i.eW)(" "+(0,a.v_)(t.timeline),1)])]),(0,i.Lk)("div",me,[e[7]||(e[7]=(0,i.Lk)("div",{class:"metrics-title"},"成功指标:",-1)),(0,i.Lk)("div",ye,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.success_metrics,t=>((0,i.uX)(),(0,i.Wv)(p,{key:t,color:"blue"},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(t),1)]),_:2},1024))),128))])])],2))),128))])])])):((0,i.uX)(),(0,i.CE)("div",be,[(0,i.bF)(f,{description:"暂无洞察数据"},{image:(0,i.k6)(()=>[(0,i.bF)(c,{style:{"font-size":"48px",color:"#d9d9d9"}})]),default:(0,i.k6)(()=>[(0,i.bF)(d,{type:"primary",onClick:n.generateInsights},{default:(0,i.k6)(()=>e[8]||(e[8]=[(0,i.eW)(" 生成洞察 ")])),_:1,__:[8]},8,["onClick"])]),_:1})]))])}var Le=s(198),Ce=s(1230),Fe=s(4501),Ie=s(7140),Ae=s(6678),Pe=s(4695),we=s(6697),Se=s(2805),Ee=s(9975),Oe=s(8416),We=s(8028),xe=s(7520),Te={name:"InsightsPanel",components:{BulbOutlined:Le.A,RiseOutlined:Ce.A,EyeOutlined:Fe.A,CheckCircleOutlined:Ie.A,LoadingOutlined:Ae.A,ClockCircleOutlined:Pe.A,UserOutlined:we.A,CalendarOutlined:Se.A,TrophyOutlined:Ee.A,ExclamationCircleOutlined:Oe.A,LineChartOutlined:We.A,SearchOutlined:xe.A},setup(){const t=$t(),e=(0,i.EW)(()=>t.isGenerating),s=(0,i.EW)(()=>t.allInsights.length>0),a=(0,i.EW)(()=>t.hasError),n=(0,i.EW)(()=>t.lastError),l=(0,i.EW)(()=>t.allInsights),r=(0,i.EW)(()=>t.allActionPlans),c=async()=>{try{await t.generateInsights(),Bt.Ay.success("洞察生成成功")}catch(e){Bt.Ay.error("洞察生成失败")}},o=async()=>{try{await t.getInsightsDemo(),Bt.Ay.success("演示数据加载成功")}catch(e){Bt.Ay.error("演示数据加载失败")}},d=()=>{t.clearInsights(),Bt.Ay.info("洞察已清空")},g=()=>{t.error=null},u=t=>{const e={trend:We.A,pattern:xe.A,opportunity:Ee.A,risk:Oe.A};return e[t]||Fe.A},h=t=>{const e={trend:"趋势",pattern:"模式",opportunity:"机会",risk:"风险"};return e[t]||"洞察"},k=t=>t>=.8?"#52c41a":t>=.6?"#faad14":"#ff4d4f",v=t=>{const e={high:"red",medium:"orange",low:"blue"};return e[t]||"default"},p=t=>{const e={high:"高影响",medium:"中影响",low:"低影响"};return e[t]||t},_=t=>{const e={P0:"red",P1:"orange",P2:"blue",P3:"green"};return e[t]||"default"};return(0,i.sV)(async()=>{try{await t.checkInsightsHealth()}catch(e){console.warn("洞察服务健康检查失败:",e)}}),{isGenerating:e,hasInsights:s,hasError:a,lastError:n,insights:l,actionPlans:r,generateInsights:c,getDemo:o,clearInsights:d,clearError:g,getInsightIcon:u,getInsightTypeText:h,getConfidenceColor:k,getImpactColor:v,getImpactText:p,getPriorityColor:_}}},Xe=s(1241);const De=(0,Xe.A)(Te,[["render",fe],["__scopeId","data-v-40cd1a96"]]);var Ke=De,ze=s(5966),Re=s(723),Be=s(7084),Ge=s(2843),Ue=s(7896),$e={name:"InsightsManagement",components:{InsightsPanel:Ke,BulbOutlined:Le.A,PlayCircleOutlined:ze.A,ReloadOutlined:Re.A,EyeOutlined:Fe.A,ExclamationCircleOutlined:Oe.A,CheckCircleOutlined:Ie.A,ClockCircleOutlined:Pe.A,SettingOutlined:Be.A,DatabaseOutlined:Ge.A,SelectOutlined:Ue.A,SearchOutlined:xe.A,LineChartOutlined:We.A,TrophyOutlined:Ee.A},setup(){const t=$t(),e=(0,Rt.KR)(!1),s=(0,Rt.KR)(!1),a=(0,Rt.KR)("all"),n=(0,Rt.KR)(""),l=(0,Rt.KR)(null),r=(0,Rt.KR)([]),c=(0,Rt.Kh)({feedback_limit:50,include_action_plans:!0,date_range:null,sentiment_filter:[]}),o=(0,Rt.Kh)({total_feedback:0,high_priority_count:0,sentiment_distribution:{positive:0,negative:0,neutral:0}}),d=(0,i.EW)(()=>t.isGenerating),g=(0,i.EW)(()=>t.allInsights),u=(0,i.EW)(()=>t.allActionPlans),h=(0,i.EW)(()=>t.highPriorityInsights),k=(0,i.EW)(()=>t.urgentActionPlans),v=(0,i.EW)(()=>t.insightsByType),p=(0,i.EW)(()=>t.actionPlansByPriority),_=(0,i.EW)(()=>t.insightsStats),m=[{title:"内容",dataIndex:"text",key:"text",ellipsis:!0},{title:"情感",dataIndex:"sentiment",key:"sentiment",width:80},{title:"分类",dataIndex:"category",key:"category",width:100},{title:"时间",dataIndex:"created_at",key:"created_at",width:150}],y={selectedRowKeys:r,onChange:t=>{r.value=t}},b=(0,Rt.KR)([]),f=(0,i.EW)(()=>b.value.filter(t=>{const e=!n.value||t.text.toLowerCase().includes(n.value.toLowerCase()),s=!l.value||t.category===l.value;return e&&s})),L=async()=>{try{await t.generateInsights(),Bt.Ay.success("洞察生成成功"),D()}catch(e){Bt.Ay.error("洞察生成失败")}},C=async()=>{try{await t.getInsightsDemo(),Bt.Ay.success("演示数据加载成功"),D()}catch(e){Bt.Ay.error("演示数据加载失败")}},F=()=>{D(),Bt.Ay.info("数据已刷新")},I=async()=>{try{const t=await Ut.WB.getFeedbacks({limit:100,status:"completed"});t.data&&t.data.data?(b.value=t.data.data.map(t=>({id:t.id,text:t.original_text||t.processed_text||"内容缺失",sentiment:t.sentiment||"neutral",category:t.category||"general",created_at:t.created_at||(new Date).toISOString(),source:t.source||"unknown",priority:t.priority||"normal",analysis_result:t.analysis_result})),console.log(`从API获取到${b.value.length}条反馈数据`)):(b.value=X(),console.log("API返回空数据，使用演示数据")),D(),Bt.Ay.success(`反馈数据已更新 (${b.value.length}条)`)}catch(t){console.error("获取反馈数据失败:",t),b.value=X(),D(),Bt.Ay.warning("使用演示数据，请检查网络连接")}},A=()=>{t.updateGenerationConfig({feedback_limit:c.feedback_limit,include_action_plans:c.include_action_plans,filters:{date_range:c.date_range,sentiment:c.sentiment_filter}}),e.value=!1,Bt.Ay.success("数据配置已更新")},P=async()=>{if(0!==r.value.length)try{await t.generateManualInsights(r.value),s.value=!1,Bt.Ay.success(`基于 ${r.value.length} 条反馈生成洞察成功`)}catch(e){Bt.Ay.error("洞察生成失败")}else Bt.Ay.warning("请选择至少一条反馈数据")},w=t=>{const e={trend:We.A,pattern:xe.A,opportunity:Ee.A,risk:Oe.A};return e[t]||Fe.A},S=t=>{const e={trend:"趋势分析",pattern:"模式识别",opportunity:"机会发现",risk:"风险预警"};return e[t]||"其他洞察"},E=t=>{const e={trend:"#1890ff",pattern:"#722ed1",opportunity:"#52c41a",risk:"#f5222d"};return e[t]||"#666"},O=t=>{const e={P0:"red",P1:"orange",P2:"blue",P3:"green"};return e[t]||"default"},W=t=>{const e={positive:"green",negative:"red",neutral:"blue"};return e[t]||"default"},x=t=>{const e={positive:"正面",negative:"负面",neutral:"中性"};return e[t]||t},T=t=>t?new Date(t).toLocaleString():"暂无",X=()=>Array.from({length:20},(t,e)=>({id:`feedback_${e+1}`,text:`这是第 ${e+1} 条用户反馈内容，包含了用户的真实想法和建议`,sentiment:["positive","negative","neutral"][e%3],category:["bug","feature","performance","ui_ux"][e%4],created_at:new Date(Date.now()-24*e*60*60*1e3).toISOString().split("T")[0]})),D=()=>{o.total_feedback=b.value.length,o.high_priority_count=Math.floor(.3*b.value.length),o.sentiment_distribution={positive:b.value.filter(t=>"positive"===t.sentiment).length,negative:b.value.filter(t=>"negative"===t.sentiment).length,neutral:b.value.filter(t=>"neutral"===t.sentiment).length}};return(0,i.sV)(()=>{I()}),{isGenerating:d,allInsights:g,allActionPlans:u,highPriorityInsights:h,urgentActionPlans:k,insightsByType:v,actionPlansByPriority:p,insightsStats:_,feedbackStats:o,showDataConfig:e,showFeedbackSelector:s,selectedCategory:a,feedbackSearch:n,feedbackCategoryFilter:l,dataConfig:c,feedbackColumns:m,feedbackRowSelection:y,filteredFeedbacks:f,generateInsights:L,getDemo:C,refreshData:F,refreshFeedbackData:I,updateDataConfig:A,generateInsightsFromSelected:P,getInsightIcon:w,getInsightTypeText:S,getInsightTypeColor:E,getPriorityColor:O,getSentimentColor:W,getSentimentText:x,formatTime:T}}};const Me=(0,Xe.A)($e,[["render",zt],["__scopeId","data-v-5dfd6a90"]]);var Qe=Me}}]);
//# sourceMappingURL=777.1569c4e9.js.map