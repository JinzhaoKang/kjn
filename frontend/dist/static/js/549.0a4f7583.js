"use strict";(self["webpackChunkfeedback_analysis_enterprise"]=self["webpackChunkfeedback_analysis_enterprise"]||[]).push([[549],{6549:function(e,a,t){t.r(a),t.d(a,{default:function(){return D}});var l=t(6768),s=t(144),u=t(4232),r=t(7694),i=t(9804),n=t(3536),o=t(723),d=t(2843),_=t(5966),c=t(7140),k=t(5226),p=t(2281),v=t(4501),m=t(5307),b=t(7181),f=t(3624),y=t(3277),g=t(4288);const F={class:"spider-management"},W={class:"page-header"},h={class:"header-content"},x={class:"page-title"},w={class:"header-actions"},A={class:"stats-cards"},X={class:"task-list"},C={key:0},R={class:"progress-info"},Q={key:1},I={key:0},K={key:1},E={key:0},q={key:2,style:{"margin-top":"16px"}},z={key:0},L={key:2,style:{"max-width":"300px",overflow:"hidden","text-overflow":"ellipsis"}};var U={__name:"SpiderManagement",setup(e){const a=(0,s.KR)(!1),t=(0,s.KR)(!1),U=(0,s.KR)(!1),T=(0,s.KR)(!1),$=(0,s.KR)(!1),D=(0,s.Kh)({total_tasks:0,running_tasks:0,completed_tasks:0,failed_tasks:0,idle_tasks:0}),S=(0,s.KR)([]),O=(0,s.KR)(""),M=(0,s.KR)(!1),j=(0,s.KR)(!1),J=(0,s.KR)(!1),N=(0,s.KR)(null),P=(0,s.KR)(null),V=(0,s.KR)(),B=(0,s.Kh)({platform:"ios",appid:"",country:"cn",days_back:30,market:"4",max_pages:10,task_name:"",execution_mode:"async"}),G=(0,l.EW)(()=>{const e={platform:[{required:!0,message:"请选择抓取平台",trigger:"change"}],max_pages:[{required:!0,message:"请输入最大页数",trigger:"blur"},{type:"number",min:1,max:1e3,message:"最大页数必须在1-1000之间",trigger:"blur"}]};return"ios"===B.platform?(e.appid=[{required:!0,message:"请输入应用ID",trigger:"blur"},{pattern:/^\d+$/,message:"应用ID必须为数字",trigger:"blur"}],e.country=[{required:!0,message:"请选择国家",trigger:"change"}],e.days_back=[{required:!0,message:"请输入回溯天数",trigger:"blur"},{type:"number",min:1,max:3650,message:"回溯天数必须在1-3650之间",trigger:"blur"}]):"android"===B.platform&&(e.market=[{required:!0,message:"请选择应用市场",trigger:"change"}]),e}),H=[{title:"任务ID",dataIndex:"task_id",key:"task_id",width:200,ellipsis:!0},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"进度",dataIndex:"progress",key:"progress",width:150},{title:"创建时间",dataIndex:"created_at",key:"created_at",width:160,customRender:({text:e})=>he(e)},{title:"执行时长",dataIndex:"duration",key:"duration",width:100},{title:"操作",key:"actions",width:200}],Y=[{title:"内容",dataIndex:"content",key:"content",width:300},{title:"评分",dataIndex:["product_info","rating"],key:"rating",width:80},{title:"情感",dataIndex:"sentiment",key:"sentiment",width:100},{title:"优先级",dataIndex:"priority",key:"priority",width:100},{title:"用户",dataIndex:["user_info","nickname"],key:"user",width:120},{title:"创建时间",dataIndex:"created_at",key:"created_at",width:160,customRender:({text:e})=>he(e)}],Z=(0,l.EW)(()=>O.value?S.value.filter(e=>e.status===O.value):S.value);let ee=null;(0,l.sV)(()=>{ae(),te(),ee=setInterval(()=>{ae(),te()},3e4)}),(0,l.hi)(()=>{ee&&clearInterval(ee)});const ae=async()=>{try{T.value=!0;const e=await g.cX.getStatistics();Object.assign(D,e.data)}catch(e){console.error("加载统计数据失败:",e),r.Ay.error("加载统计数据失败")}finally{T.value=!1}},te=async()=>{try{U.value=!0;const e=await g.cX.getTaskList();S.value=e.data.tasks||[]}catch(e){r.Ay.error("加载任务列表失败"),console.error("加载任务列表失败:",e)}finally{U.value=!1}},le=async()=>{t.value=!0,await Promise.all([ae(),te()]),t.value=!1,r.Ay.success("刷新成功")},se=()=>{M.value=!0},ue=()=>{"ios"===B.platform?(B.appid="",B.country="cn",B.days_back=30):"android"===B.platform&&(B.market="4")},re=()=>{M.value=!1,V.value?.resetFields(),Object.assign(B,{platform:"ios",appid:"",country:"cn",days_back:30,market:"4",max_pages:10,task_name:"",execution_mode:"async"})},ie=async()=>{try{let e;await V.value.validate(),$.value=!0,"ios"===B.platform?e=await g.cX.createQimaiTask({appid:B.appid,country:B.country,days_back:B.days_back,max_pages:B.max_pages,task_name:B.task_name}):"android"===B.platform&&(e=await g.cX.createQimaiAndroidTask({market:B.market,max_pages:B.max_pages,task_name:B.task_name})),"async"===B.execution_mode?(await g.cX.runTask(e.data.task_id),r.Ay.success("爬虫任务创建成功，开始后台执行")):r.Ay.success("爬虫任务创建成功"),re(),await te(),await ae()}catch(e){r.Ay.error("创建任务失败"),console.error("创建任务失败:",e)}finally{$.value=!1}},ne=async e=>{try{await g.cX.runTask(e),r.Ay.success("任务开始执行"),await te()}catch(a){r.Ay.error("启动任务失败"),console.error("启动任务失败:",a)}},oe=async e=>{try{await g.cX.pauseTask(e),r.Ay.success("任务已暂停"),await te()}catch(a){r.Ay.error("暂停任务失败"),console.error("暂停任务失败:",a)}},de=async e=>{try{await g.cX.resumeTask(e),r.Ay.success("任务已恢复"),await te()}catch(a){r.Ay.error("恢复任务失败"),console.error("恢复任务失败:",a)}},_e=async e=>{i.A.confirm({title:"确认停止任务？",content:"停止后的任务无法恢复，确定要停止吗？",onOk:async()=>{try{await g.cX.stopTask(e),r.Ay.success("任务已停止"),await te()}catch(a){r.Ay.error("停止任务失败"),console.error("停止任务失败:",a)}}})},ce=async e=>{N.value=e,j.value=!0},ke=async e=>{try{const a=await g.cX.previewTaskData(e);P.value=a.data,J.value=!0}catch(a){r.Ay.error("预览数据失败"),console.error("预览数据失败:",a)}},pe=async e=>{i.A.confirm({title:"确认导入数据？",content:"确定要将此任务的数据导入到系统中吗？",onOk:async()=>{try{a.value=!0;const t=await g.cX.importTaskData(e);r.Ay.success(`数据导入成功，共导入 ${t.data.imported_count} 条数据`)}catch(t){r.Ay.error("导入数据失败"),console.error("导入数据失败:",t)}finally{a.value=!1}}})},ve=async()=>{i.A.confirm({title:"确认清理过期任务？",content:"将清理7天前完成的任务，确定继续吗？",onOk:async()=>{try{const e=await g.cX.cleanupTasks();r.Ay.success(`清理完成，删除了 ${e.data.cleaned_count} 个过期任务`),await te(),await ae()}catch(e){r.Ay.error("清理任务失败"),console.error("清理任务失败:",e)}}})},me=e=>e?"android"===e.platform?"Android应用市场":"ios"===e.platform||e.appid?"iOS App Store":"未知平台":"未知",be=e=>{const a={idle:"default",running:"processing",completed:"success",error:"error",paused:"warning",stopped:"default"};return a[e]||"default"},fe=e=>{const a={idle:"空闲",running:"运行中",completed:"已完成",error:"失败",paused:"暂停",stopped:"已停止"};return a[e]||e},ye=e=>{const a={positive:"green",negative:"red",neutral:"blue"};return a[e]||"default"},ge=e=>{const a={positive:"正面",negative:"负面",neutral:"中性"};return a[e]||e},Fe=e=>{const a={high:"red",medium:"orange",low:"green"};return a[e]||"default"},We=e=>{if(e.spider_status?.metrics){const a=e.spider_status.metrics;if(a.total_requests>0)return Math.round(a.successful_requests/a.total_requests*100)}return 0},he=e=>e?new Date(e).toLocaleString("zh-CN"):"-",xe=e=>{if(!e||e<0)return"-";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}h ${t}m ${l}s`:t>0?`${t}m ${l}s`:`${l}s`};return(e,r)=>{const i=(0,l.g2)("a-icon"),g=(0,l.g2)("a-button"),S=(0,l.g2)("a-statistic"),ee=(0,l.g2)("a-card"),ae=(0,l.g2)("a-col"),te=(0,l.g2)("a-row"),we=(0,l.g2)("a-spin"),Ae=(0,l.g2)("a-select-option"),Xe=(0,l.g2)("a-select"),Ce=(0,l.g2)("a-space"),Re=(0,l.g2)("a-tag"),Qe=(0,l.g2)("a-progress"),Ie=(0,l.g2)("a-tooltip"),Ke=(0,l.g2)("a-table"),Ee=(0,l.g2)("a-radio"),qe=(0,l.g2)("a-radio-group"),ze=(0,l.g2)("a-form-item"),Le=(0,l.g2)("a-input"),Ue=(0,l.g2)("a-input-number"),Te=(0,l.g2)("a-form"),$e=(0,l.g2)("a-modal"),De=(0,l.g2)("a-descriptions-item"),Se=(0,l.g2)("a-descriptions"),Oe=(0,l.g2)("a-divider"),Me=(0,l.g2)("a-alert");return(0,l.uX)(),(0,l.CE)("div",F,[(0,l.Lk)("div",W,[(0,l.Lk)("div",h,[(0,l.Lk)("h1",x,[(0,l.bF)(i,{type:"spider"}),r[12]||(r[12]=(0,l.eW)(" 爬虫管理 "))]),r[13]||(r[13]=(0,l.Lk)("p",{class:"page-description"},"管理和监控爬虫任务，自动化采集用户反馈数据",-1))]),(0,l.Lk)("div",w,[(0,l.bF)(g,{type:"primary",onClick:se,loading:a.value},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(n.A))]),default:(0,l.k6)(()=>[r[14]||(r[14]=(0,l.eW)(" 创建爬虫任务 "))]),_:1,__:[14]},8,["loading"]),(0,l.bF)(g,{onClick:le,loading:t.value},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(o.A))]),default:(0,l.k6)(()=>[r[15]||(r[15]=(0,l.eW)(" 刷新 "))]),_:1,__:[15]},8,["loading"])])]),(0,l.Lk)("div",A,[(0,l.bF)(we,{spinning:T.value},{default:(0,l.k6)(()=>[(0,l.bF)(te,{gutter:16},{default:(0,l.k6)(()=>[(0,l.bF)(ae,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(ee,null,{default:(0,l.k6)(()=>[(0,l.bF)(S,{title:"总任务数",value:D.total_tasks,"value-style":{color:"#1890ff"}},{prefix:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(d.A))]),_:1},8,["value"])]),_:1})]),_:1}),(0,l.bF)(ae,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(ee,null,{default:(0,l.k6)(()=>[(0,l.bF)(S,{title:"运行中",value:D.running_tasks,"value-style":{color:"#52c41a"}},{prefix:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(_.A))]),_:1},8,["value"])]),_:1})]),_:1}),(0,l.bF)(ae,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(ee,null,{default:(0,l.k6)(()=>[(0,l.bF)(S,{title:"已完成",value:D.completed_tasks,"value-style":{color:"#13c2c2"}},{prefix:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(c.A))]),_:1},8,["value"])]),_:1})]),_:1}),(0,l.bF)(ae,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(ee,null,{default:(0,l.k6)(()=>[(0,l.bF)(S,{title:"失败数",value:D.failed_tasks,"value-style":{color:"#ff4d4f"}},{prefix:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(k.A))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["spinning"])]),(0,l.Lk)("div",X,[(0,l.bF)(ee,{title:"爬虫任务列表",bordered:!1},{extra:(0,l.k6)(()=>[(0,l.bF)(Ce,null,{default:(0,l.k6)(()=>[(0,l.bF)(Xe,{value:O.value,"onUpdate:value":r[0]||(r[0]=e=>O.value=e),placeholder:"筛选状态",style:{width:"120px"},"allow-clear":""},{default:(0,l.k6)(()=>[(0,l.bF)(Ae,{value:"idle"},{default:(0,l.k6)(()=>r[16]||(r[16]=[(0,l.eW)("空闲")])),_:1,__:[16]}),(0,l.bF)(Ae,{value:"running"},{default:(0,l.k6)(()=>r[17]||(r[17]=[(0,l.eW)("运行中")])),_:1,__:[17]}),(0,l.bF)(Ae,{value:"completed"},{default:(0,l.k6)(()=>r[18]||(r[18]=[(0,l.eW)("已完成")])),_:1,__:[18]}),(0,l.bF)(Ae,{value:"error"},{default:(0,l.k6)(()=>r[19]||(r[19]=[(0,l.eW)("失败")])),_:1,__:[19]}),(0,l.bF)(Ae,{value:"paused"},{default:(0,l.k6)(()=>r[20]||(r[20]=[(0,l.eW)("暂停")])),_:1,__:[20]})]),_:1},8,["value"]),(0,l.bF)(g,{onClick:ve,type:"text",danger:""},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(p.A))]),default:(0,l.k6)(()=>[r[21]||(r[21]=(0,l.eW)(" 清理过期任务 "))]),_:1,__:[21]})]),_:1})]),default:(0,l.k6)(()=>[(0,l.bF)(Ke,{columns:H,"data-source":Z.value,loading:U.value,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0},"row-key":"task_id"},{bodyCell:(0,l.k6)(({column:e,record:a})=>["status"===e.key?((0,l.uX)(),(0,l.Wv)(Re,{key:0,color:be(a.status)},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(fe(a.status)),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"duration"===e.key?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)((0,u.v_)(xe(a.duration)),1)],64)):(0,l.Q3)("",!0),"progress"===e.key?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},["running"===a.status&&a.spider_status?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.bF)(Qe,{percent:We(a),size:"small",status:"error"===a.status?"exception":"active"},null,8,["percent","status"]),(0,l.Lk)("div",R,[(0,l.Lk)("span",null,(0,u.v_)(a.spider_status.metrics?.total_items||0)+" 条数据",1),(0,l.Lk)("span",null,(0,u.v_)((a.spider_status.metrics?.items_per_second||0).toFixed(1))+" 条/秒",1)])])):a.result_summary?((0,l.uX)(),(0,l.CE)("div",Q,[(0,l.bF)(Re,{color:"success"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(a.result_summary.data_count)+" 条数据",1)]),_:2},1024)])):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0),"actions"===e.key?((0,l.uX)(),(0,l.Wv)(Ce,{key:3},{default:(0,l.k6)(()=>[(0,l.bF)(Ie,{title:"查看详情"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",onClick:e=>ce(a),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(v.A))]),_:2},1032,["onClick"])]),_:2},1024),"idle"===a.status?((0,l.uX)(),(0,l.Wv)(Ie,{key:0,title:"运行任务"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",onClick:e=>ne(a.task_id),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(_.A))]),_:2},1032,["onClick"])]),_:2},1024)):(0,l.Q3)("",!0),"running"===a.status?((0,l.uX)(),(0,l.Wv)(Ie,{key:1,title:"暂停任务"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",onClick:e=>oe(a.task_id),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(m.A))]),_:2},1032,["onClick"])]),_:2},1024)):(0,l.Q3)("",!0),"paused"===a.status?((0,l.uX)(),(0,l.Wv)(Ie,{key:2,title:"恢复任务"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",onClick:e=>de(a.task_id),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(_.A))]),_:2},1032,["onClick"])]),_:2},1024)):(0,l.Q3)("",!0),["running","paused"].includes(a.status)?((0,l.uX)(),(0,l.Wv)(Ie,{key:3,title:"停止任务"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",danger:"",onClick:e=>_e(a.task_id),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(b.A))]),_:2},1032,["onClick"])]),_:2},1024)):(0,l.Q3)("",!0),"completed"===a.status?((0,l.uX)(),(0,l.Wv)(Ie,{key:4,title:"预览数据"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",onClick:e=>ke(a.task_id),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(f.A))]),_:2},1032,["onClick"])]),_:2},1024)):(0,l.Q3)("",!0),"completed"===a.status?((0,l.uX)(),(0,l.Wv)(Ie,{key:5,title:"导入数据"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"text",onClick:e=>pe(a.task_id),size:"small"},{icon:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(y.A))]),_:2},1032,["onClick"])]),_:2},1024)):(0,l.Q3)("",!0)]),_:2},1024)):(0,l.Q3)("",!0)]),_:1},8,["data-source","loading"])]),_:1})]),(0,l.bF)($e,{open:M.value,"onUpdate:open":r[9]||(r[9]=e=>M.value=e),title:"创建爬虫任务",onOk:ie,onCancel:re,"confirm-loading":$.value,width:"600px"},{default:(0,l.k6)(()=>[(0,l.bF)(Te,{ref_key:"createFormRef",ref:V,model:B,rules:G.value,layout:"vertical"},{default:(0,l.k6)(()=>[(0,l.bF)(ze,{label:"抓取平台",name:"platform"},{default:(0,l.k6)(()=>[(0,l.bF)(qe,{value:B.platform,"onUpdate:value":r[1]||(r[1]=e=>B.platform=e),onChange:ue},{default:(0,l.k6)(()=>[(0,l.bF)(Ee,{value:"ios"},{default:(0,l.k6)(()=>r[22]||(r[22]=[(0,l.eW)("iOS App Store")])),_:1,__:[22]}),(0,l.bF)(Ee,{value:"android"},{default:(0,l.k6)(()=>r[23]||(r[23]=[(0,l.eW)("Android应用市场")])),_:1,__:[23]})]),_:1},8,["value"])]),_:1}),"ios"===B.platform?((0,l.uX)(),(0,l.CE)("div",I,[(0,l.bF)(te,{gutter:16},{default:(0,l.k6)(()=>[(0,l.bF)(ae,{span:12},{default:(0,l.k6)(()=>[(0,l.bF)(ze,{label:"应用ID",name:"appid"},{default:(0,l.k6)(()=>[(0,l.bF)(Le,{value:B.appid,"onUpdate:value":r[2]||(r[2]=e=>B.appid=e),placeholder:"输入App Store应用ID",maxlength:20},null,8,["value"])]),_:1})]),_:1}),(0,l.bF)(ae,{span:12},{default:(0,l.k6)(()=>[(0,l.bF)(ze,{label:"国家/地区",name:"country"},{default:(0,l.k6)(()=>[(0,l.bF)(Xe,{value:B.country,"onUpdate:value":r[3]||(r[3]=e=>B.country=e),placeholder:"选择国家"},{default:(0,l.k6)(()=>[(0,l.bF)(Ae,{value:"cn"},{default:(0,l.k6)(()=>r[24]||(r[24]=[(0,l.eW)("中国")])),_:1,__:[24]}),(0,l.bF)(Ae,{value:"us"},{default:(0,l.k6)(()=>r[25]||(r[25]=[(0,l.eW)("美国")])),_:1,__:[25]}),(0,l.bF)(Ae,{value:"jp"},{default:(0,l.k6)(()=>r[26]||(r[26]=[(0,l.eW)("日本")])),_:1,__:[26]}),(0,l.bF)(Ae,{value:"kr"},{default:(0,l.k6)(()=>r[27]||(r[27]=[(0,l.eW)("韩国")])),_:1,__:[27]}),(0,l.bF)(Ae,{value:"uk"},{default:(0,l.k6)(()=>r[28]||(r[28]=[(0,l.eW)("英国")])),_:1,__:[28]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),(0,l.bF)(ze,{label:"回溯天数",name:"days_back"},{default:(0,l.k6)(()=>[(0,l.bF)(Ue,{value:B.days_back,"onUpdate:value":r[4]||(r[4]=e=>B.days_back=e),min:1,max:3650,placeholder:"回溯天数",style:{width:"100%"}},null,8,["value"])]),_:1})])):(0,l.Q3)("",!0),"android"===B.platform?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.bF)(ze,{label:"应用市场",name:"market"},{default:(0,l.k6)(()=>[(0,l.bF)(Xe,{value:B.market,"onUpdate:value":r[5]||(r[5]=e=>B.market=e),placeholder:"选择应用市场"},{default:(0,l.k6)(()=>[(0,l.bF)(Ae,{value:"4"},{default:(0,l.k6)(()=>r[29]||(r[29]=[(0,l.eW)("小米应用市场")])),_:1,__:[29]}),(0,l.bF)(Ae,{value:"6"},{default:(0,l.k6)(()=>r[30]||(r[30]=[(0,l.eW)("华为应用市场")])),_:1,__:[30]}),(0,l.bF)(Ae,{value:"7"},{default:(0,l.k6)(()=>r[31]||(r[31]=[(0,l.eW)("魅族应用市场")])),_:1,__:[31]}),(0,l.bF)(Ae,{value:"8"},{default:(0,l.k6)(()=>r[32]||(r[32]=[(0,l.eW)("vivo应用市场")])),_:1,__:[32]}),(0,l.bF)(Ae,{value:"9"},{default:(0,l.k6)(()=>r[33]||(r[33]=[(0,l.eW)("oppo应用市场")])),_:1,__:[33]})]),_:1},8,["value"])]),_:1})])):(0,l.Q3)("",!0),(0,l.bF)(ze,{label:"最大页数",name:"max_pages"},{default:(0,l.k6)(()=>[(0,l.bF)(Ue,{value:B.max_pages,"onUpdate:value":r[6]||(r[6]=e=>B.max_pages=e),min:1,max:1e3,placeholder:"最大抓取页数",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,l.bF)(ze,{label:"任务名称",name:"task_name"},{default:(0,l.k6)(()=>[(0,l.bF)(Le,{value:B.task_name,"onUpdate:value":r[7]||(r[7]=e=>B.task_name=e),placeholder:"可选，不填写将自动生成",maxlength:50},null,8,["value"])]),_:1}),(0,l.bF)(ze,{label:"执行方式",name:"execution_mode"},{default:(0,l.k6)(()=>[(0,l.bF)(qe,{value:B.execution_mode,"onUpdate:value":r[8]||(r[8]=e=>B.execution_mode=e)},{default:(0,l.k6)(()=>[(0,l.bF)(Ee,{value:"async"},{default:(0,l.k6)(()=>r[34]||(r[34]=[(0,l.eW)("后台执行")])),_:1,__:[34]}),(0,l.bF)(Ee,{value:"sync"},{default:(0,l.k6)(()=>r[35]||(r[35]=[(0,l.eW)("立即执行")])),_:1,__:[35]})]),_:1},8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),(0,l.bF)($e,{open:j.value,"onUpdate:open":r[10]||(r[10]=e=>j.value=e),title:`任务详情 - ${N.value?.task_id}`,footer:null,width:"800px"},{default:(0,l.k6)(()=>[N.value?((0,l.uX)(),(0,l.CE)("div",E,[(0,l.bF)(Se,{column:2,bordered:""},{default:(0,l.k6)(()=>[(0,l.bF)(De,{label:"任务ID"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.task_id),1)]),_:1}),(0,l.bF)(De,{label:"状态"},{default:(0,l.k6)(()=>[(0,l.bF)(Re,{color:be(N.value.status)},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(fe(N.value.status)),1)]),_:1},8,["color"])]),_:1}),(0,l.bF)(De,{label:"创建时间"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(he(N.value.created_at)),1)]),_:1}),(0,l.bF)(De,{label:"开始时间"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(he(N.value.started_at)),1)]),_:1}),(0,l.bF)(De,{label:"完成时间"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(he(N.value.completed_at)),1)]),_:1}),(0,l.bF)(De,{label:"执行时长"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(xe(N.value.duration)),1)]),_:1})]),_:1}),(0,l.bF)(Oe,null,{default:(0,l.k6)(()=>r[36]||(r[36]=[(0,l.eW)("任务参数")])),_:1,__:[36]}),(0,l.bF)(Se,{column:2,bordered:""},{default:(0,l.k6)(()=>[(0,l.bF)(De,{label:"平台"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(me(N.value.task_params)),1)]),_:1}),N.value.task_params?.appid?((0,l.uX)(),(0,l.Wv)(De,{key:0,label:"应用ID"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.task_params.appid),1)]),_:1})):(0,l.Q3)("",!0),N.value.task_params?.country?((0,l.uX)(),(0,l.Wv)(De,{key:1,label:"国家"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.task_params.country),1)]),_:1})):(0,l.Q3)("",!0),N.value.task_params?.days_back?((0,l.uX)(),(0,l.Wv)(De,{key:2,label:"回溯天数"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.task_params.days_back),1)]),_:1})):(0,l.Q3)("",!0),N.value.task_params?.market?((0,l.uX)(),(0,l.Wv)(De,{key:3,label:"应用市场"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.task_params.market_name||`市场${N.value.task_params.market}`),1)]),_:1})):(0,l.Q3)("",!0),(0,l.bF)(De,{label:"最大页数"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.task_params?.max_pages),1)]),_:1})]),_:1}),N.value.spider_status?((0,l.uX)(),(0,l.Wv)(Oe,{key:0},{default:(0,l.k6)(()=>r[37]||(r[37]=[(0,l.eW)("执行指标")])),_:1,__:[37]})):(0,l.Q3)("",!0),N.value.spider_status?((0,l.uX)(),(0,l.Wv)(Se,{key:1,column:2,bordered:""},{default:(0,l.k6)(()=>[(0,l.bF)(De,{label:"总请求数"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.spider_status.metrics?.total_requests||0),1)]),_:1}),(0,l.bF)(De,{label:"成功请求"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.spider_status.metrics?.successful_requests||0),1)]),_:1}),(0,l.bF)(De,{label:"失败请求"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.spider_status.metrics?.failed_requests||0),1)]),_:1}),(0,l.bF)(De,{label:"成功率"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)((100*(N.value.spider_status.metrics?.success_rate||0)).toFixed(1))+"%",1)]),_:1}),(0,l.bF)(De,{label:"抓取条目"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.spider_status.metrics?.total_items||0),1)]),_:1}),(0,l.bF)(De,{label:"有效条目"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(N.value.spider_status.metrics?.valid_items||0),1)]),_:1}),(0,l.bF)(De,{label:"处理速度"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)((N.value.spider_status.metrics?.items_per_second||0).toFixed(2))+" 条/秒",1)]),_:1})]),_:1})):(0,l.Q3)("",!0),N.value.error?((0,l.uX)(),(0,l.CE)("div",q,[(0,l.bF)(Me,{type:"error",message:N.value.error,"show-icon":""},null,8,["message"])])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),_:1},8,["open","title"]),(0,l.bF)($e,{open:J.value,"onUpdate:open":r[11]||(r[11]=e=>J.value=e),title:"数据预览",footer:null,width:"1000px"},{default:(0,l.k6)(()=>[P.value?((0,l.uX)(),(0,l.CE)("div",z,[(0,l.bF)(Se,{column:3,bordered:"",style:{"margin-bottom":"16px"}},{default:(0,l.k6)(()=>[(0,l.bF)(De,{label:"总数据量"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(P.value.total_count),1)]),_:1}),(0,l.bF)(De,{label:"预览数量"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(P.value.preview_count),1)]),_:1}),(0,l.bF)(De,{label:"任务状态"},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(P.value.task_info?.status),1)]),_:1})]),_:1}),(0,l.bF)(Ke,{columns:Y,"data-source":P.value.preview_data,pagination:!1,size:"small",scroll:{x:1200}},{bodyCell:(0,l.k6)(({column:e,record:a})=>["sentiment"===e.key?((0,l.uX)(),(0,l.Wv)(Re,{key:0,color:ye(a.sentiment)},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(ge(a.sentiment)),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"priority"===e.key?((0,l.uX)(),(0,l.Wv)(Re,{key:1,color:Fe(a.priority)},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(a.priority),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"content"===e.key?((0,l.uX)(),(0,l.CE)("div",L,(0,u.v_)(a.content),1)):(0,l.Q3)("",!0)]),_:1},8,["data-source"])])):(0,l.Q3)("",!0)]),_:1},8,["open"])])}}},T=t(1241);const $=(0,T.A)(U,[["__scopeId","data-v-6f0ecf0e"]]);var D=$}}]);
//# sourceMappingURL=549.0a4f7583.js.map