"use strict";(self["webpackChunkfeedback_analysis_enterprise"]=self["webpackChunkfeedback_analysis_enterprise"]||[]).push([[801],{3801:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var l=a(6768),n=a(4232);const r={class:"feedback-management"},o={key:0,class:"feedback-wrapper"},s={class:"feedback-card"},i={key:0,class:"feedback-header"},d={class:"feedback-title"},c={class:"feedback-body"},u={key:0,class:"keywords-section"},g={class:"keywords-text"},_={key:1,class:"analysis-status"},k={class:"analysis-indicators"},b={key:0,class:"analysis-check ai-analyzed",title:"已完成AI分析"},p={key:1,class:"analysis-check pre-filtered",title:"已预筛选处理"},y=["title"],v=["title"],f={key:3,class:"status-indicator"},m={class:"status-text"},F={key:5,class:"time-display"},h={class:"relative-time"},C={class:"absolute-time"},w={key:0},A={class:"feedback-content"};function S(e,t,a,S,W,x){const O=(0,l.g2)("a-button"),L=(0,l.g2)("PlusOutlined"),z=(0,l.g2)("a-space"),I=(0,l.g2)("a-page-header"),T=(0,l.g2)("SearchOutlined"),$=(0,l.g2)("a-input"),E=(0,l.g2)("a-col"),R=(0,l.g2)("a-select-option"),X=(0,l.g2)("a-select"),Q=(0,l.g2)("a-row"),U=(0,l.g2)("a-card"),D=(0,l.g2)("a-tag"),K=(0,l.g2)("a-table"),P=(0,l.g2)("a-form-item"),M=(0,l.g2)("a-textarea"),q=(0,l.g2)("a-form"),j=(0,l.g2)("a-modal"),B=(0,l.g2)("a-descriptions-item"),G=(0,l.g2)("a-descriptions"),V=(0,l.g2)("a-drawer");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.bF)(I,{title:"反馈管理","sub-title":"管理和处理用户反馈"},{extra:(0,l.k6)(()=>[(0,l.bF)(z,null,{default:(0,l.k6)(()=>[(0,l.bF)(O,{type:"primary",loading:S.analyzing,onClick:S.triggerAnalyzeAll,style:{background:"#52c41a","border-color":"#52c41a"}},{default:(0,l.k6)(()=>t[11]||(t[11]=[(0,l.eW)(" 🤖 一键AI分析 ")])),_:1,__:[11]},8,["loading","onClick"]),(0,l.bF)(O,{type:"primary",loading:S.reanalyzing,onClick:S.triggerForceReanalyze,style:{background:"#722ed1","border-color":"#722ed1"}},{default:(0,l.k6)(()=>t[12]||(t[12]=[(0,l.eW)(" 🔄 优化重新分析 ")])),_:1,__:[12]},8,["loading","onClick"]),(0,l.bF)(O,{type:"primary",onClick:t[0]||(t[0]=e=>S.showCreateDialog=!0)},{default:(0,l.k6)(()=>[(0,l.bF)(L),t[13]||(t[13]=(0,l.eW)(" 添加反馈 "))]),_:1,__:[13]})]),_:1})]),_:1}),(0,l.bF)(U,{class:"filter-card"},{default:(0,l.k6)(()=>[(0,l.bF)(Q,{gutter:16},{default:(0,l.k6)(()=>[(0,l.bF)(E,{span:8},{default:(0,l.k6)(()=>[(0,l.bF)($,{value:S.searchQuery,"onUpdate:value":t[1]||(t[1]=e=>S.searchQuery=e),placeholder:"搜索反馈内容...",onPressEnter:S.handleSearch,allowClear:""},{prefix:(0,l.k6)(()=>[(0,l.bF)(T)]),_:1},8,["value","onPressEnter"])]),_:1}),(0,l.bF)(E,{span:5},{default:(0,l.k6)(()=>[(0,l.bF)(X,{value:S.statusFilter,"onUpdate:value":t[2]||(t[2]=e=>S.statusFilter=e),placeholder:"选择状态",onChange:S.loadFeedback,allowClear:"",style:{width:"100%"}},{default:(0,l.k6)(()=>[(0,l.bF)(R,{value:"pending"},{default:(0,l.k6)(()=>t[14]||(t[14]=[(0,l.eW)("待处理")])),_:1,__:[14]}),(0,l.bF)(R,{value:"processing"},{default:(0,l.k6)(()=>t[15]||(t[15]=[(0,l.eW)("处理中")])),_:1,__:[15]}),(0,l.bF)(R,{value:"completed"},{default:(0,l.k6)(()=>t[16]||(t[16]=[(0,l.eW)("已完成")])),_:1,__:[16]}),(0,l.bF)(R,{value:"rejected"},{default:(0,l.k6)(()=>t[17]||(t[17]=[(0,l.eW)("已拒绝")])),_:1,__:[17]})]),_:1},8,["value","onChange"])]),_:1}),(0,l.bF)(E,{span:5},{default:(0,l.k6)(()=>[(0,l.bF)(X,{value:S.categoryFilter,"onUpdate:value":t[3]||(t[3]=e=>S.categoryFilter=e),placeholder:"选择分类",onChange:S.loadFeedback,allowClear:"",style:{width:"100%"}},{default:(0,l.k6)(()=>[(0,l.bF)(R,{value:"feature"},{default:(0,l.k6)(()=>t[18]||(t[18]=[(0,l.eW)("功能建议")])),_:1,__:[18]}),(0,l.bF)(R,{value:"bug"},{default:(0,l.k6)(()=>t[19]||(t[19]=[(0,l.eW)("问题报告")])),_:1,__:[19]}),(0,l.bF)(R,{value:"ux"},{default:(0,l.k6)(()=>t[20]||(t[20]=[(0,l.eW)("用户体验")])),_:1,__:[20]}),(0,l.bF)(R,{value:"performance"},{default:(0,l.k6)(()=>t[21]||(t[21]=[(0,l.eW)("性能优化")])),_:1,__:[21]}),(0,l.bF)(R,{value:"other"},{default:(0,l.k6)(()=>t[22]||(t[22]=[(0,l.eW)("其他")])),_:1,__:[22]})]),_:1},8,["value","onChange"])]),_:1}),(0,l.bF)(E,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(z,null,{default:(0,l.k6)(()=>[(0,l.bF)(O,{type:"primary",onClick:S.loadFeedback},{default:(0,l.k6)(()=>t[23]||(t[23]=[(0,l.eW)("搜索")])),_:1,__:[23]},8,["onClick"]),(0,l.bF)(O,{onClick:S.resetFilters},{default:(0,l.k6)(()=>t[24]||(t[24]=[(0,l.eW)("重置")])),_:1,__:[24]},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),(0,l.bF)(U,{class:"table-card"},{default:(0,l.k6)(()=>[(0,l.bF)(K,{columns:S.feedbackColumns,"data-source":S.feedbackList,loading:S.loading,pagination:S.pagination,"row-selection":S.rowSelection,onChange:S.handleTableChange,size:"small"},{bodyCell:(0,l.k6)(({column:e,record:a})=>["feedback_content"===e.key?((0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("div",s,[S.getFeedbackTitle(a)?((0,l.uX)(),(0,l.CE)("div",i,[t[25]||(t[25]=(0,l.Lk)("span",{class:"title-icon"},"💬",-1)),(0,l.Lk)("span",d,(0,n.v_)(S.getFeedbackTitle(a)),1)])):(0,l.Q3)("",!0),(0,l.Lk)("div",c,[(0,l.Lk)("div",{class:(0,n.C4)(["feedback-content",{expanded:a.expanded}])},(0,n.v_)(S.getFeedbackContent(a)),3),a.keywords&&a.keywords.length>0?((0,l.uX)(),(0,l.CE)("div",u,[t[26]||(t[26]=(0,l.Lk)("span",{class:"keywords-label"},"🏷️ 关键词：",-1)),(0,l.Lk)("span",g,(0,n.v_)(a.keywords.slice(0,5).join(" · "))+(0,n.v_)(a.keywords.length>5?"...":""),1)])):(0,l.Q3)("",!0),a.analysis_result||a.processing_status?((0,l.uX)(),(0,l.CE)("div",_,[(0,l.Lk)("span",k,[a.analysis_result&&"multi_model_ai"===a.analysis_result.analysis_method||a.processing_status&&"multi_model_ai"===a.processing_status.analysis_method?((0,l.uX)(),(0,l.CE)("span",b," ✅ AI分析 ")):a.analysis_result&&"intelligent_filter"===a.analysis_result.analysis_method||a.processing_status&&"intelligent_filter"===a.processing_status.analysis_method?((0,l.uX)(),(0,l.CE)("span",p," ⚡ 预筛选 ")):(0,l.Q3)("",!0),a.sentiment?((0,l.uX)(),(0,l.CE)("span",{key:2,class:(0,n.C4)(["sentiment-indicator",`sentiment-${a.sentiment}`]),title:`情感：${S.getSentimentLabel(a.sentiment)}`},(0,n.v_)(S.getSentimentLabel(a.sentiment)),11,y)):(0,l.Q3)("",!0),a.ai_confidence&&a.ai_confidence>0?((0,l.uX)(),(0,l.CE)("span",{key:3,class:"confidence-indicator",title:`AI分析置信度：${Math.round(100*a.ai_confidence)}%`},(0,n.v_)(Math.round(100*a.ai_confidence))+"% ",9,v)):(0,l.Q3)("",!0)])])):(0,l.Q3)("",!0),S.needsExpansion(a)?((0,l.uX)(),(0,l.Wv)(O,{key:2,type:"link",size:"small",class:"expand-btn",onClick:e=>S.toggleExpansion(a)},{icon:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(a.expanded?"UpOutlined":"DownOutlined")))]),default:(0,l.k6)(()=>[(0,l.eW)(" "+(0,n.v_)(a.expanded?"收起":"展开"),1)]),_:2},1032,["onClick"])):(0,l.Q3)("",!0)])])])):(0,l.Q3)("",!0),"source"===e.key?((0,l.uX)(),(0,l.Wv)(D,{key:1,color:S.getSourceColor(a.source),class:"modern-source-tag"},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(S.getSourceIcon(a.source)),{class:"tag-icon"})),(0,l.Lk)("span",null,(0,n.v_)(S.getSourceLabel(a.source)),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"category"===e.key?((0,l.uX)(),(0,l.Wv)(D,{key:2,color:S.getCategoryColor(a.category),class:"category-main-tag"},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.getCategoryLabel(a.category)),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"status"===e.key?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("span",{class:(0,n.C4)(["status-dot",S.getStatusClass(a.status)])},null,2),(0,l.Lk)("span",m,(0,n.v_)(S.getStatusLabel(a.status)),1)])):(0,l.Q3)("",!0),"priority"===e.key?((0,l.uX)(),(0,l.Wv)(D,{key:4,color:S.getPriorityColor(a.priority),class:"priority-badge"},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.getPriorityText(a.priority)),1)]),_:2},1032,["color"])):(0,l.Q3)("",!0),"created_at"===e.key?((0,l.uX)(),(0,l.CE)("div",F,[(0,l.Lk)("div",h,(0,n.v_)(S.getRelativeTime(a.created_at)),1),(0,l.Lk)("div",C,(0,n.v_)(S.formatAbsoluteTime(a.created_at)),1)])):(0,l.Q3)("",!0)]),_:1},8,["columns","data-source","loading","pagination","row-selection","onChange"])]),_:1}),(0,l.bF)(j,{visible:S.showCreateDialog,"onUpdate:visible":t[9]||(t[9]=e=>S.showCreateDialog=e),title:S.editingFeedback?"编辑反馈":"创建反馈",onOk:S.saveFeedback,onCancel:S.cancelEdit,width:"600px"},{default:(0,l.k6)(()=>[(0,l.bF)(q,{model:S.feedbackForm,"label-col":{span:6},"wrapper-col":{span:18},ref:"feedbackFormRef"},{default:(0,l.k6)(()=>[(0,l.bF)(P,{label:"标题",name:"title",rules:[{required:!0,message:"请输入反馈标题"}]},{default:(0,l.k6)(()=>[(0,l.bF)($,{value:S.feedbackForm.title,"onUpdate:value":t[4]||(t[4]=e=>S.feedbackForm.title=e),placeholder:"请输入反馈标题"},null,8,["value"])]),_:1}),(0,l.bF)(P,{label:"内容",name:"content",rules:[{required:!0,message:"请输入反馈内容"}]},{default:(0,l.k6)(()=>[(0,l.bF)(M,{value:S.feedbackForm.content,"onUpdate:value":t[5]||(t[5]=e=>S.feedbackForm.content=e),rows:4,placeholder:"请详细描述您的反馈..."},null,8,["value"])]),_:1}),(0,l.bF)(P,{label:"分类",name:"category",rules:[{required:!0,message:"请选择反馈分类"}]},{default:(0,l.k6)(()=>[(0,l.bF)(X,{value:S.feedbackForm.category,"onUpdate:value":t[6]||(t[6]=e=>S.feedbackForm.category=e),placeholder:"请选择分类"},{default:(0,l.k6)(()=>[(0,l.bF)(R,{value:"feature"},{default:(0,l.k6)(()=>t[27]||(t[27]=[(0,l.eW)("功能建议")])),_:1,__:[27]}),(0,l.bF)(R,{value:"bug"},{default:(0,l.k6)(()=>t[28]||(t[28]=[(0,l.eW)("问题报告")])),_:1,__:[28]}),(0,l.bF)(R,{value:"ux"},{default:(0,l.k6)(()=>t[29]||(t[29]=[(0,l.eW)("用户体验")])),_:1,__:[29]}),(0,l.bF)(R,{value:"performance"},{default:(0,l.k6)(()=>t[30]||(t[30]=[(0,l.eW)("性能优化")])),_:1,__:[30]}),(0,l.bF)(R,{value:"other"},{default:(0,l.k6)(()=>t[31]||(t[31]=[(0,l.eW)("其他")])),_:1,__:[31]})]),_:1},8,["value"])]),_:1}),(0,l.bF)(P,{label:"优先级",name:"priority"},{default:(0,l.k6)(()=>[(0,l.bF)(X,{value:S.feedbackForm.priority,"onUpdate:value":t[7]||(t[7]=e=>S.feedbackForm.priority=e),placeholder:"请选择优先级"},{default:(0,l.k6)(()=>[(0,l.bF)(R,{value:"low"},{default:(0,l.k6)(()=>t[32]||(t[32]=[(0,l.eW)("低")])),_:1,__:[32]}),(0,l.bF)(R,{value:"normal"},{default:(0,l.k6)(()=>t[33]||(t[33]=[(0,l.eW)("普通")])),_:1,__:[33]}),(0,l.bF)(R,{value:"high"},{default:(0,l.k6)(()=>t[34]||(t[34]=[(0,l.eW)("高")])),_:1,__:[34]}),(0,l.bF)(R,{value:"urgent"},{default:(0,l.k6)(()=>t[35]||(t[35]=[(0,l.eW)("紧急")])),_:1,__:[35]})]),_:1},8,["value"])]),_:1}),(0,l.bF)(P,{label:"联系邮箱",name:"email"},{default:(0,l.k6)(()=>[(0,l.bF)($,{value:S.feedbackForm.email,"onUpdate:value":t[8]||(t[8]=e=>S.feedbackForm.email=e),placeholder:"请输入您的邮箱地址"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","onOk","onCancel"]),(0,l.bF)(V,{visible:S.showViewDialog,"onUpdate:visible":t[10]||(t[10]=e=>S.showViewDialog=e),title:"反馈详情",placement:"right",width:"600"},{default:(0,l.k6)(()=>[S.selectedFeedback?((0,l.uX)(),(0,l.CE)("div",w,[(0,l.bF)(G,{column:2,bordered:""},{default:(0,l.k6)(()=>[(0,l.bF)(B,{label:"ID"},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.selectedFeedback.id),1)]),_:1}),(0,l.bF)(B,{label:"状态"},{default:(0,l.k6)(()=>[(0,l.bF)(D,{color:S.getStatusColor(S.selectedFeedback.status)},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.getStatusLabel(S.selectedFeedback.status)),1)]),_:1},8,["color"])]),_:1}),(0,l.bF)(B,{label:"标题",span:2},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.selectedFeedback.title),1)]),_:1}),(0,l.bF)(B,{label:"分类"},{default:(0,l.k6)(()=>[(0,l.bF)(D,{color:S.getCategoryColor(S.selectedFeedback.category)},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.getCategoryLabel(S.selectedFeedback.category)),1)]),_:1},8,["color"])]),_:1}),(0,l.bF)(B,{label:"优先级"},{default:(0,l.k6)(()=>[(0,l.bF)(D,{color:S.getPriorityColor(S.selectedFeedback.priority)},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.getPriorityText(S.selectedFeedback.priority)),1)]),_:1},8,["color"])]),_:1}),(0,l.bF)(B,{label:"创建时间",span:2},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.selectedFeedback.created_at),1)]),_:1}),(0,l.bF)(B,{label:"联系邮箱",span:2},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(S.selectedFeedback.email||"未提供"),1)]),_:1}),(0,l.bF)(B,{label:"反馈内容",span:2},{default:(0,l.k6)(()=>[(0,l.Lk)("div",A,(0,n.v_)(S.selectedFeedback.content),1)]),_:1})]),_:1})])):(0,l.Q3)("",!0)]),_:1},8,["visible"])])}var W=a(144),x=a(7694),O=a(9804),L=a(3536),z=a(7520),I=a(5862),T=a(9070),$=a(6638),E=a(6712),R=a(1855),X=a(7084),Q=a(6697),U=a(6736),D=a(5389),K=a(4288),P={name:"FeedbackManagement",components:{PlusOutlined:L.A,SearchOutlined:z.A,AppleOutlined:I.A,AndroidOutlined:T.A,GlobalOutlined:$.A,TeamOutlined:E.A,CustomerServiceOutlined:R.A,SettingOutlined:X.A,UserOutlined:Q.A,UpOutlined:U.A,DownOutlined:D.A},setup(){const e=(0,W.KR)(!1),t=(0,W.KR)(!1),a=(0,W.KR)(!1),n=(0,W.KR)([]),r=(0,W.KR)(null),o=(0,W.KR)(!1),s=(0,W.KR)(!1),i=(0,W.KR)(null),d=(0,W.KR)(null),c=(0,W.KR)(""),u=(0,W.KR)(void 0),g=(0,W.KR)(void 0),_=(0,W.KR)({current:1,pageSize:50,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`第 ${t[0]}-${t[1]} 条，共 ${e} 条`,pageSizeOptions:["20","50","100","200"]}),k=(0,W.Kh)({title:"",content:"",category:void 0,priority:"normal",email:""}),b=[{title:"反馈内容",dataIndex:"feedback_content",key:"feedback_content",ellipsis:!0,width:"55%"},{title:"来源渠道",dataIndex:"source",key:"source",width:"12%",align:"center"},{title:"问题分类",dataIndex:"category",key:"category",width:"10%",align:"center"},{title:"处理状态",dataIndex:"status",key:"status",width:"10%",align:"center"},{title:"优先级",dataIndex:"priority",key:"priority",width:"8%",align:"center"},{title:"提交时间",dataIndex:"created_at",key:"created_at",width:"10%",align:"center"}],p={onChange:(e,t)=>{console.log("选中的反馈:",t)}},y=e=>{const t={pending:"orange",processing:"blue",completed:"green",rejected:"red"};return t[e]||"default"},v=e=>{const t={pending:"待处理",processing:"处理中",completed:"已完成",rejected:"已拒绝"};return t[e]||e},f=e=>{const t={feature:"blue",feature_request:"blue",bug:"red",bug_report:"red",ux:"green",ux_complaint:"green",performance:"orange",question:"cyan",praise:"green",general:"default",other:"default"};return t[e]||"default"},m=e=>{const t={feature:"功能建议",feature_request:"功能需求",bug:"问题报告",bug_report:"Bug报告",ux:"用户体验",ux_complaint:"UX投诉",performance:"性能优化",question:"咨询问题",praise:"表扬反馈",general:"通用反馈",other:"其他"};return t[e]||e},F=e=>{const t={low:"green",medium:"orange",normal:"orange",high:"red",urgent:"volcano"};return t[e]||"orange"},h=e=>{const t={low:"低",medium:"中等",normal:"普通",high:"高",urgent:"紧急"};return t[e]||e},C=e=>{if(e.title&&e.title.trim()){const t=e.title.replace(/\s+/g," ").trim();return t.length>30?t.substring(0,30)+"...":t}const t=e.original_text||e.content||e.original_content||e.processed_text||"";if(t){const e=t.replace(/\s+/g," ").trim();return e.length>20?e.substring(0,20)+"...":e}return"无标题"},w=e=>{const t=e.original_text||e.content||e.original_content||e.processed_text||"";if(!t)return"暂无内容";const a=t.replace(/[ \t]+/g," ").trim();return e.expanded?a:a.length>120?a.substring(0,120)+"...":a},A=e=>{const t=e.original_text||e.content||e.original_content||e.processed_text||"",a=t.replace(/[ \t]+/g," ").trim();return a.length>120},S=e=>{const t=n.value.findIndex(t=>t._id===e._id);-1!==t&&(n.value[t].expanded=!n.value[t].expanded)},L=e=>{const t={app_store:"AppleOutlined",google_play:"AndroidOutlined",social_media:"GlobalOutlined",internal:"TeamOutlined",zendesk:"CustomerServiceOutlined",user_survey:"SettingOutlined"};return t[e]||"SettingOutlined"},z=e=>{const t={app_store:"App Store",ios_app_store:"iOS App Store",android_app_store:"Android应用市场",google_play:"Google Play",huawei_app_store:"华为应用市场",xiaomi_app_store:"小米应用市场",vivo_app_store:"vivo应用市场",oppo_app_store:"OPPO应用市场",meizu_app_store:"魅族应用市场",social_media:"社交平台",internal:"内部系统",zendesk:"客服工单",user_survey:"用户调研"};return t[e]||e||"Unknown"},I=e=>{const t={positive:"green",negative:"red",neutral:"default"};return t[e]||"default"},T=e=>{const t={positive:"正面",negative:"负面",neutral:"中性"};return t[e]||e},$=e=>{const t={multi_model_ai:"green",intelligent_filter:"orange",content_empty:"red",manual:"blue"};return t[e]||"default"},E=e=>{const t={multi_model_ai:"AI分析",intelligent_filter:"预筛选",content_empty:"内容空",manual:"手动"};return t[e]||e},R=e=>e&&"none"!==e?e.includes("gemini")?"Gemini":e.includes("gpt")?"GPT":e.includes("claude")?"Claude":"default"===e?"默认":"intelligent_filter"===e?"预筛选":e.substring(0,10):"",X=e=>{const t={app_store:"blue",google_play:"green",social_media:"purple",internal:"orange",zendesk:"cyan",user_survey:"geekblue"};return t[e]||"default"},Q=e=>{const t={pending:"status-pending",in_progress:"status-processing",resolved:"status-success",closed:"status-default"};return t[e]||"status-default"},U=e=>{if(!e)return"--";try{const t=new Date(e),a=new Date,l=a.getTime()-t.getTime(),n=Math.floor(l/6e4),r=Math.floor(l/36e5),o=Math.floor(l/864e5);return n<1?"刚刚":n<60?`${n}分钟前`:r<24?`${r}小时前`:o<7?`${o}天前`:o<30?`${Math.floor(o/7)}周前`:`${Math.floor(o/30)}个月前`}catch(t){return"--"}},D=e=>{if(!e)return"--";try{const t=new Date(e),a=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),n=t.getHours().toString().padStart(2,"0"),r=t.getMinutes().toString().padStart(2,"0");return`${a}-${l} ${n}:${r}`}catch(t){return"--"}},P=async()=>{e.value=!0;try{const e={skip:(_.value.current-1)*_.value.pageSize,limit:_.value.pageSize};u.value&&(e.status=u.value),g.value&&(e.source=g.value);const t=await K.WB.getFeedbacks(e);t.data&&(n.value=(t.data.data||[]).map(e=>({...e,expanded:!1})),_.value.total=t.data.total||0,console.log("✅ 从数据库加载反馈数据:",{"总数":_.value.total,"当前页":n.value.length,"页码":_.value.current}))}catch(t){console.error("❌ 加载反馈数据失败:",t),x.Ay.error("加载反馈数据失败："+(t.response?.data?.detail||t.message)),n.value=[],_.value.total=0}finally{e.value=!1}},M=()=>{_.value.current=1,P()},q=()=>{c.value="",u.value=void 0,g.value=void 0,_.value.current=1,P()},j=(e,t,a)=>{_.value=e,P()},B=e=>{r.value=e,s.value=!0},G=e=>{i.value=e,Object.assign(k,{title:e.title,content:e.content,category:e.category,priority:e.priority,email:e.email}),o.value=!0},V=e=>{O.A.confirm({title:"确认分析",content:"确定要对此反馈进行智能分析吗？",onOk(){x.Ay.success("分析任务已启动"),P()}})},H=async e=>{O.A.confirm({title:"确认删除",content:`确定要删除反馈"${e.title}"吗？此操作不可恢复。`,okType:"danger",async onOk(){try{await K.WB.deleteFeedback(e.id),x.Ay.success("反馈删除成功"),P()}catch(t){x.Ay.error("删除失败："+(t.response?.data?.detail||t.message))}}})},J=()=>{d.value.validate().then(()=>{i.value?x.Ay.success("反馈更新成功"):x.Ay.success("反馈创建成功"),o.value=!1,Y(),P()}).catch(()=>{x.Ay.error("请检查表单内容")})},N=()=>{o.value=!1,Y()},Y=()=>{Object.assign(k,{title:"",content:"",category:void 0,priority:"normal",email:""}),i.value=null,d.value?.resetFields()};(0,l.sV)(()=>{P()});const Z=async()=>{t.value=!0;try{const e=await K.WB.analyzeAllUnprocessed(),t=e.data;0===t.unanalyzed_count?x.Ay.success("🎉 所有反馈数据都已完成AI分析！"):(x.Ay.success(`🚀 成功启动AI分析！正在处理 ${t.unanalyzed_count} 条反馈数据，预计需要 ${t.analysis_details.estimated_time}`),setTimeout(()=>{P()},3e3)),console.log("✅ AI分析任务启动成功:",t)}catch(e){console.error("❌ AI分析启动失败:",e),x.Ay.error("AI分析启动失败："+(e.response?.data?.detail||e.message))}finally{t.value=!1}},ee=async()=>{a.value=!0;try{const e=await K.WB.forceReanalyzeAll(),t=e.data;x.Ay.success(`🔄 ${t.message}`),setTimeout(()=>{P()},5e3),console.log("✅ 强制重新分析启动成功:",t)}catch(e){console.error("❌ 强制重新分析启动失败:",e),x.Ay.error("强制重新分析启动失败："+(e.response?.data?.detail||e.message))}finally{a.value=!1}};return{loading:e,analyzing:t,reanalyzing:a,feedbackList:n,selectedFeedback:r,showCreateDialog:o,showViewDialog:s,editingFeedback:i,feedbackFormRef:d,searchQuery:c,statusFilter:u,categoryFilter:g,pagination:_,feedbackForm:k,feedbackColumns:b,rowSelection:p,getStatusColor:y,getStatusLabel:v,getCategoryColor:f,getCategoryLabel:m,getPriorityColor:F,getPriorityText:h,getFeedbackTitle:C,getFeedbackContent:w,needsExpansion:A,toggleExpansion:S,getSourceIcon:L,getSourceLabel:z,getSourceColor:X,getStatusClass:Q,getRelativeTime:U,formatAbsoluteTime:D,getSentimentColor:I,getSentimentLabel:T,getAnalysisMethodColor:$,getAnalysisMethodLabel:E,getModelLabel:R,loadFeedback:P,handleSearch:M,resetFilters:q,handleTableChange:j,viewFeedback:B,editFeedback:G,analyzeFeedback:V,deleteFeedback:H,saveFeedback:J,cancelEdit:N,resetForm:Y,triggerAnalyzeAll:Z,triggerForceReanalyze:ee}}},M=a(1241);const q=(0,M.A)(P,[["render",S],["__scopeId","data-v-468f5785"]]);var j=q}}]);
//# sourceMappingURL=801.a81e20bd.js.map